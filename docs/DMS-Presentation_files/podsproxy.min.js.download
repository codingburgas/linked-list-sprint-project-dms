function _array_like_to_array(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function _array_with_holes(e){if(Array.isArray(e))return e}function _array_without_holes(e){if(Array.isArray(e))return _array_like_to_array(e)}function asyncGeneratorStep(e,r,t,n,o,i,s){try{var a=e[i](s),u=a.value}catch(e){return void t(e)}a.done?r(u):Promise.resolve(u).then(n,o)}function _async_to_generator(e){return function(){var r=this,t=arguments;return new Promise((function(n,o){var i=e.apply(r,t);function s(e){asyncGeneratorStep(i,n,o,s,a,"next",e)}function a(e){asyncGeneratorStep(i,n,o,s,a,"throw",e)}s(void 0)}))}}function _class_call_check(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _create_class(e,r,t){return r&&_defineProperties(e.prototype,r),t&&_defineProperties(e,t),e}function _define_property(e,r,t){return r in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}function _instanceof(e,r){return null!=r&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?!!r[Symbol.hasInstance](e):e instanceof r}function _iterable_to_array(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _iterable_to_array_limit(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var n,o,i=[],s=!0,a=!1;try{for(t=t.call(e);!(s=(n=t.next()).done)&&(i.push(n.value),!r||i.length!==r);s=!0);}catch(e){a=!0,o=e}finally{try{s||null==t.return||t.return()}finally{if(a)throw o}}return i}}function _non_iterable_rest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _non_iterable_spread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _object_spread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{},n=Object.keys(t);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(t).filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})))),n.forEach((function(r){_define_property(e,r,t[r])}))}return e}function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function _object_spread_props(e,r){return r=null!=r?r:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ownKeys(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})),e}function _sliced_to_array(e,r){return _array_with_holes(e)||_iterable_to_array_limit(e,r)||_unsupported_iterable_to_array(e,r)||_non_iterable_rest()}function _to_consumable_array(e){return _array_without_holes(e)||_iterable_to_array(e)||_unsupported_iterable_to_array(e)||_non_iterable_spread()}function _type_of(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function _unsupported_iterable_to_array(e,r){if(e){if("string"==typeof e)return _array_like_to_array(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_array_like_to_array(e,r):void 0}}function _ts_generator(e,r){var t,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;s;)try{if(t=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,n=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=r.call(e,s)}catch(e){i=[6,e],n=0}finally{t=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}!function(e,r){"object"===("undefined"==typeof exports?"undefined":_type_of(exports))&&"object"===("undefined"==typeof module?"undefined":_type_of(module))?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"===("undefined"==typeof exports?"undefined":_type_of(exports))?exports.PodsProxy=r():e.PodsProxy=r()}(globalThis,(function(){return function(){"use strict";var e={227:function(e){var r,t="object"===("undefined"==typeof Reflect?"undefined":_type_of(Reflect))?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,r,t){return Function.prototype.apply.call(e,r,t)};r=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var o=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}e.exports=i,e.exports.once=function(e,r){return new Promise((function(t,n){function o(t){e.removeListener(r,i),n(t)}function i(){"function"==typeof e.removeListener&&e.removeListener("error",o),t([].slice.call(arguments))}y(e,r,i,{once:!0}),"error"!==r&&function(e,r,t){"function"==typeof e.on&&y(e,"error",r,{once:!0})}(e,o)}))},i.EventEmitter=i,i.prototype.t=void 0,i.prototype.i=0,i.prototype.u=void 0;var s=10;function a(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+(void 0===e?"undefined":_type_of(e)))}function u(e){return void 0===e.u?i.defaultMaxListeners:e.u}function c(e,r,t,n){var o,i,s,c;if(a(t),void 0===(i=e.t)?(i=e.t=Object.create(null),e.i=0):(void 0!==i.newListener&&(e.emit("newListener",r,t.listener?t.listener:t),i=e.t),s=i[r]),void 0===s)s=i[r]=t,++e.i;else if("function"==typeof s?s=i[r]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),(o=u(e))>0&&s.length>o&&!s.warned){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(r)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=e,d.type=r,d.count=s.length,c=d,console&&console.warn&&console.warn(c)}return e}function d(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function l(e,r,t){var n={fired:!1,wrapFn:void 0,target:e,type:r,listener:t},o=d.bind(n);return o.listener=t,n.wrapFn=o,o}function f(e,r,t){var n=e.t;if(void 0===n)return[];var o=n[r];return void 0===o?[]:"function"==typeof o?t?[o.listener||o]:[o]:t?function(e){for(var r=new Array(e.length),t=0;t<r.length;++t)r[t]=e[t].listener||e[t];return r}(o):_(o,o.length)}function p(e){var r=this.t;if(void 0!==r){var t=r[e];if("function"==typeof t)return 1;if(void 0!==t)return t.length}return 0}function _(e,r){for(var t=new Array(r),n=0;n<r;++n)t[n]=e[n];return t}function y(e,r,t,n){if("function"==typeof e.on)n.once?e.once(r,t):e.on(r,t);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+(void 0===e?"undefined":_type_of(e)));e.addEventListener(r,(function o(i){n.once&&e.removeEventListener(r,o),t(i)}))}}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){void 0!==this.t&&this.t!==Object.getPrototypeOf(this).t||(this.t=Object.create(null),this.i=0),this.u=this.u||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||o(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this.u=e,this},i.prototype.getMaxListeners=function(){return u(this)},i.prototype.emit=function(e){for(var r=[],t=1;t<arguments.length;t++)r.push(arguments[t]);var o="error"===e,i=this.t;if(void 0!==i)o=o&&void 0===i.error;else if(!o)return!1;if(o){var s;if(r.length>0&&(s=r[0]),_instanceof(s,Error))throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var u=i[e];if(void 0===u)return!1;if("function"==typeof u)n(u,this,r);else{var c=u.length,d=_(u,c);for(t=0;t<c;++t)n(d[t],this,r)}return!0},i.prototype.addListener=function(e,r){return c(this,e,r,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,r){return c(this,e,r,!0)},i.prototype.once=function(e,r){return a(r),this.on(e,l(this,e,r)),this},i.prototype.prependOnceListener=function(e,r){return a(r),this.prependListener(e,l(this,e,r)),this},i.prototype.removeListener=function(e,r){var t,n,o,i,s;if(a(r),void 0===(n=this.t))return this;if(void 0===(t=n[e]))return this;if(t===r||t.listener===r)0==--this.i?this.t=Object.create(null):(delete n[e],n.removeListener&&this.emit("removeListener",e,t.listener||r));else if("function"!=typeof t){for(o=-1,i=t.length-1;i>=0;i--)if(t[i]===r||t[i].listener===r){s=t[i].listener,o=i;break}if(o<0)return this;0===o?t.shift():function(e,r){for(;r+1<e.length;r++)e[r]=e[r+1];e.pop()}(t,o),1===t.length&&(n[e]=t[0]),void 0!==n.removeListener&&this.emit("removeListener",e,s||r)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var r,t,n;if(void 0===(t=this.t))return this;if(void 0===t.removeListener)return 0===arguments.length?(this.t=Object.create(null),this.i=0):void 0!==t[e]&&(0==--this.i?this.t=Object.create(null):delete t[e]),this;if(0===arguments.length){var o,i=Object.keys(t);for(n=0;n<i.length;++n)"removeListener"!==(o=i[n])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this.t=Object.create(null),this.i=0,this}if("function"==typeof(r=t[e]))this.removeListener(e,r);else if(void 0!==r)for(n=r.length-1;n>=0;n--)this.removeListener(e,r[n]);return this},i.prototype.listeners=function(e){return f(this,e,!0)},i.prototype.rawListeners=function(e){return f(this,e,!1)},i.listenerCount=function(e,r){return"function"==typeof e.listenerCount?e.listenerCount(r):p.call(e,r)},i.prototype.listenerCount=p,i.prototype.eventNames=function(){return this.i>0?r(this.t):[]}},37:function(e,r){Object.defineProperty(r,"__esModule",{value:!0}),r.ChangeGate=void 0;var t=function(){function e(){}return e.initSettings=function(e){e.disabledChangeGates&&(this.m_disabledChangeGateList=e.disabledChangeGates.split(";"))},e.isChangeGateEnabled=function(e){return!!e&&(!this.m_disabledChangeGateList||this.m_disabledChangeGateList.indexOf(e)<0)},e.m_disabledChangeGateList=[""],e}();r.ChangeGate=t},276:function(e,r){Object.defineProperty(r,"__esModule",{value:!0})},176:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var n=t(533);n.__exportStar(t(276),r),n.__exportStar(t(37),r)},533:function(e,r,t){t.r(r),t.d(r,{__addDisposableResource:function(){return j},__assign:function(){return i},__asyncDelegator:function(){return P},__asyncGenerator:function(){return C},__asyncValues:function(){return E},__await:function(){return w},__awaiter:function(){return _},__classPrivateFieldGet:function(){return T},__classPrivateFieldIn:function(){return R},__classPrivateFieldSet:function(){return k},__createBinding:function(){return h},__decorate:function(){return a},__disposeResources:function(){return W},__esDecorate:function(){return c},__exportStar:function(){return m},__extends:function(){return o},__generator:function(){return y},__importDefault:function(){return M},__importStar:function(){return A},__makeTemplateObject:function(){return x},__metadata:function(){return p},__param:function(){return u},__propKey:function(){return l},__read:function(){return g},__rest:function(){return s},__runInitializers:function(){return d},__setFunctionName:function(){return f},__spread:function(){return I},__spreadArray:function(){return b},__spreadArrays:function(){return S},__values:function(){return v},default:function(){return U}});var n=function(e,r){return n=Object.setPrototypeOf||_instanceof({__proto__:[]},Array)&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)Object.prototype.hasOwnProperty.call(r,t)&&(e[t]=r[t])},n(e,r)};function o(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}var i=function(){return i=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var o in r=arguments[t])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},i.apply(this,arguments)};function s(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)r.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(t[n[o]]=e[n[o]])}return t}function a(e,r,t,n){var o,i=arguments.length,s=i<3?r:null===n?n=Object.getOwnPropertyDescriptor(r,t):n;if("object"===("undefined"==typeof Reflect?"undefined":_type_of(Reflect))&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,r,t,n);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(r,t,s):o(r,t))||s);return i>3&&s&&Object.defineProperty(r,t,s),s}function u(e,r){return function(t,n){r(t,n,e)}}function c(e,r,t,n,o,i){function s(e){if(void 0!==e&&"function"!=typeof e)throw new TypeError("Function expected");return e}for(var a,u=n.kind,c="getter"===u?"get":"setter"===u?"set":"value",d=!r&&e?n.static?e:e.prototype:null,l=r||(d?Object.getOwnPropertyDescriptor(d,n.name):{}),f=!1,p=t.length-1;p>=0;p--){var _={};for(var y in n)_[y]="access"===y?{}:n[y];for(var y in n.access)_.access[y]=n.access[y];_.addInitializer=function(e){if(f)throw new TypeError("Cannot add initializers after decoration has completed");i.push(s(e||null))};var h=(0,t[p])("accessor"===u?{get:l.get,set:l.set}:l[c],_);if("accessor"===u){if(void 0===h)continue;if(null===h||"object"!==(void 0===h?"undefined":_type_of(h)))throw new TypeError("Object expected");(a=s(h.get))&&(l.get=a),(a=s(h.set))&&(l.set=a),(a=s(h.init))&&o.unshift(a)}else(a=s(h))&&("field"===u?o.unshift(a):l[c]=a)}d&&Object.defineProperty(d,n.name,l),f=!0}function d(e,r,t){for(var n=arguments.length>2,o=0;o<r.length;o++)t=n?r[o].call(e,t):r[o].call(e);return n?t:void 0}function l(e){return"symbol"===(void 0===e?"undefined":_type_of(e))?e:"".concat(e)}function f(e,r,t){return"symbol"===(void 0===r?"undefined":_type_of(r))&&(r=r.description?"[".concat(r.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:t?"".concat(t," ",r):r})}function p(e,r){if("object"===("undefined"==typeof Reflect?"undefined":_type_of(Reflect))&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,r)}function _(e,r,t,n){return new(t||(t=Promise))((function(o,i){function s(e){try{u(n.next(e))}catch(e){i(e)}}function a(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var r;e.done?o(e.value):(r=e.value,_instanceof(r,t)?r:new t((function(e){e(r)}))).then(s,a)}u((n=n.apply(e,r||[])).next())}))}function y(e,r){var t,n,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(a){return function(u){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i&&(i=0,a[0]&&(s=0)),s;)try{if(t=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,n=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!((o=(o=s.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=r.call(e,s)}catch(e){a=[6,e],n=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var h=Object.create?function(e,r,t,n){void 0===n&&(n=t);var o=Object.getOwnPropertyDescriptor(r,t);o&&!("get"in o?!r.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return r[t]}}),Object.defineProperty(e,n,o)}:function(e,r,t,n){void 0===n&&(n=t),e[n]=r[t]};function m(e,r){for(var t in e)"default"===t||Object.prototype.hasOwnProperty.call(r,t)||h(r,e,t)}function v(e){var r="function"==typeof Symbol&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function g(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,o,i=t.call(e),s=[];try{for(;(void 0===r||r-- >0)&&!(n=i.next()).done;)s.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(t=i.return)&&t.call(i)}finally{if(o)throw o.error}}return s}function I(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(g(arguments[r]));return e}function S(){for(var e=0,r=0,t=arguments.length;r<t;r++)e+=arguments[r].length;var n=Array(e),o=0;for(r=0;r<t;r++)for(var i=arguments[r],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}function b(e,r,t){if(t||2===arguments.length)for(var n,o=0,i=r.length;o<i;o++)!n&&o in r||(n||(n=Array.prototype.slice.call(r,0,o)),n[o]=r[o]);return e.concat(n||Array.prototype.slice.call(r))}function w(e){return _instanceof(this,w)?(this.v=e,this):new w(e)}function C(e,r,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=t.apply(e,r||[]),i=[];return n={},s("next"),s("throw"),s("return"),n[Symbol.asyncIterator]=function(){return this},n;function s(e){o[e]&&(n[e]=function(r){return new Promise((function(t,n){i.push([e,r,t,n])>1||a(e,r)}))})}function a(e,r){try{_instanceof((t=o[e](r)).value,w)?Promise.resolve(t.value.v).then(u,c):d(i[0][2],t)}catch(e){d(i[0][3],e)}var t}function u(e){a("next",e)}function c(e){a("throw",e)}function d(e,r){e(r),i.shift(),i.length&&a(i[0][0],i[0][1])}}function P(e){var r,t;return r={},n("next"),n("throw",(function(e){throw e})),n("return"),r[Symbol.iterator]=function(){return this},r;function n(n,o){r[n]=e[n]?function(r){return(t=!t)?{value:w(e[n](r)),done:!1}:o?o(r):r}:o}}function E(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,t=e[Symbol.asyncIterator];return t?t.call(e):(e=v(e),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(t){r[t]=e[t]&&function(r){return new Promise((function(n,o){!function(e,r,t,n){Promise.resolve(n).then((function(r){e({value:r,done:t})}),r)}(n,o,(r=e[t](r)).done,r.value)}))}}}function x(e,r){return Object.defineProperty?Object.defineProperty(e,"raw",{value:r}):e.raw=r,e}var O=Object.create?function(e,r){Object.defineProperty(e,"default",{enumerable:!0,value:r})}:function(e,r){e.default=r};function A(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)"default"!==t&&Object.prototype.hasOwnProperty.call(e,t)&&h(r,e,t);return O(r,e),r}function M(e){return e&&e.__esModule?e:{default:e}}function T(e,r,t,n){if("a"===t&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof r?e!==r||!n:!r.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===t?n:"a"===t?n.call(e):n?n.value:r.get(e)}function k(e,r,t,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof r?e!==r||!o:!r.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,t):o?o.value=t:r.set(e,t),t}function R(e,r){if(null===r||"object"!==(void 0===r?"undefined":_type_of(r))&&"function"!=typeof r)throw new TypeError("Cannot use 'in' operator on non-object");return"function"==typeof e?r===e:e.has(r)}function j(e,r,t){if(null!=r){if("object"!==(void 0===r?"undefined":_type_of(r))&&"function"!=typeof r)throw new TypeError("Object expected.");var n;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");n=r[Symbol.asyncDispose]}if(void 0===n){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");n=r[Symbol.dispose]}if("function"!=typeof n)throw new TypeError("Object not disposable.");e.stack.push({value:r,dispose:n,async:t})}else t&&e.stack.push({async:!0});return r}var N="function"==typeof SuppressedError?SuppressedError:function(e,r,t){var n=new Error(t);return n.name="SuppressedError",n.error=e,n.suppressed=r,n};function W(e){function r(r){e.error=e.hasError?new N(r,e.error,"An error was suppressed during disposal."):r,e.hasError=!0}return function t(){for(;e.stack.length;){var n=e.stack.pop();try{var o=n.dispose&&n.dispose.call(n.value);if(n.async)return Promise.resolve(o).then(t,(function(e){return r(e),t()}))}catch(e){r(e)}}if(e.hasError)throw e.error}()}var U={__extends:o,__assign:i,__rest:s,__decorate:a,__param:u,__metadata:p,__awaiter:_,__generator:y,__createBinding:h,__exportStar:m,__values:v,__read:g,__spread:I,__spreadArrays:S,__spreadArray:b,__await:w,__asyncGenerator:C,__asyncDelegator:P,__asyncValues:E,__makeTemplateObject:x,__importStar:A,__importDefault:M,__classPrivateFieldGet:T,__classPrivateFieldSet:k,__classPrivateFieldIn:R,__addDisposableResource:j,__disposeResources:W}}},r={};function t(n){var o=r[n];if(void 0!==o)return o.exports;var i=r[n]={exports:{}};return e[n](i,i.exports,t),i.exports}t.d=function(e,r){for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n,o,i={};t.r(i),t.d(i,{ClientColorSettings:function(){return s},ErrorCategory:function(){return d},ErrorCode:function(){return c},GetRequestItemIds:function(){return l},ItemType:function(){return f},PodsProxy:function(){return C},PodsProxyConstants:function(){return u},PodsProxyRequestStageType:function(){return o},PodsProxyRequestType:function(){return n},SlideImageAppendOption:function(){return a},exposed:function(){return b},setupGlobals_PodsProxy:function(){return w}}),function(e){e.getPresInfoAsync="getPresInfoAsync",e.getItemsPresInfoAndSlideInfoAsync="getItemsPresInfoAndSlideInfoAsync",e.getItemsSlideInfosAsync="getItemsSlideInfosAsync",e.getSlideInfosAsync="getSlideInfosAsync"}(n||(n={})),function(e){e.GetItemsCall="GetItemsCall",e.DownloadResponseStream="DownloadResponseStream",e.ParseMultipartResponse="ParseMultipartResponse"}(o||(o={}));var s,a,u=function e(){_class_call_check(this,e)};u.unknown="unknown",u.ErrorCode="ErrorCode",u.ErrorCategory="ErrorCategory",u.errorCategory="errorCategory",u.errorCode="errorCode",u.IsIntentional="IsIntentional",u.isIntentional="isIntentional",u.XCorrelationId="X-CorrelationId",u.ContentType="Content-Type",u.ContentLength="Content-Length",u.ContenEncoding="Content-Encoding",u.TransferEncoding="Transfer-Encoding",u.XusedOutputCache="X-usedOutputCache",u.Xnewsnapurl="x-newsnapurl",u.ContentDisposition="Content-Disposition",u.CallerCorrelationId="CallerCorrelationId",u.action="action",u.parser="parser",u.server="server",u.callId="callId",u.dateHeader="x-ms-date",u.clientTimeoutHeader="x-ms-client-timeout",u.clientRequestIdHeader="x-ms-client-request-id",u.newSnapUrlHeader="x-newsnapurl",u.correlationId="correlationId",u.firstResponseCheck="firstResponseCheck",u.fetchBoundary="fetchBoundary",u.downloadResponse="downloadResponse",u.parserCallback="parserCallback",u.createResponse="createResponse",u.contentLength="contentLength",u.usedOutputCache="usedOutputCache",u.itemUsedOutputCacheMap="itemUsedOutputCacheMap",u.podsProxyCallSuceeded="podsProxyCallSuceeded",u.PriorityHint="PriorityHint",u.RequestInfo="RequestInfo",u.ResponseHeaders="ResponseHeaders",u.IsBootRequest="IsBootRequest",u.XErrorCode="X-ErrorCode",function(e){e.None="None",e.BlackColorTheme="#FFFFFF_#000000_#FFFF00"}(s||(s={})),function(e){e[e.None=0]="None",e[e.All=1]="All",e[e.Partial=2]="Partial",e[e.Embed=3]="Embed"}(a||(a={}));var c,d,l=function e(){_class_call_check(this,e)};l.PresInfoMetaData="presinfo/metadata",l.PresinfoslimSlideOrder="presinfo/slimSlideOrder",l.slideInfoIndex="pres/sldIdx",l.slideInfoSid="pres/sldSid",l.slideNotesIndex="pres/NotesSldIdx",l.slideNotesSid="pres/NotesSldSid",l.slideCommentsIndex="pres/CommentsSldIdx",l.slideCommentsSid="pres/CommentsSldSid",l.slideMetadataIndex="pres/SlideMetadatasldIdx",l.slideMetadataSid="pres/SlideMetadataSldSid",l.slideAccessibilityModelIndex="pres/SlideAccessibilityModelSldIdx",l.slideAccessibilityModelSid="pres/SlideAccessibilityModelSldSid",function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.ErrorRESERVEDItemFailed="ErrorRESERVEDItemFailed",e.ErrorDownloadResponseStreamTimeout="ErrorDownloadResponseStreamTimeout",e.ErrorRequestFailed="ErrorRequestFailed",e.ErrorRequestFailedServiceUnavailable="ErrorRequestFailedServiceUnavailable",e.ErrorRequestFailedBadGateway="ErrorRequestFailedBadGateway",e.ErrorRequestFailedGatewayTimeout="ErrorRequestFailedGatewayTimeout",e.ErrorRequestFailedServerNotFound="ErrorRequestFailedServerNotFound",e.ErrorContentDispositionHeaderNotValid="ErrorContentDispositionHeaderNotValid",e.ErrorItemNameNotValid="ErrorItemNameNotValid",e.ErrorResponseNotValid="ErrorResponseNotValid",e.ErrorCannotParseResponse="ErrorCannotParseResponse",e.ErrorRequestTimeout="ErrorRequestTimeout",e.ErrorFailedToFetch="ErrorFailedToFetch",e.ErrorRequestCanceled="ErrorRequestCanceled",e.ErrorRequestAbort="ErrorRequestAbort",e.ErrorConnectionLost="ErrorConnectionLost",e.ErrorSoftwareConnectionAbort="ErrorSoftwareConnectionAbort",e.ErrorFailedToDownloadFile="ErrorFailedToDownloadFile",e.ErrorFileDownloadNetworkError="ErrorFileDownloadNetworkError",e.ErrorFileDownloadResourceInconsistent="ErrorFileDownloadResourceInconsistent",e.ErrorResourceInconsistentResnaptimeout="ErrorResourceInconsistentResnaptimeout",e.ErrorResourceInconsistentResnapNotStarted="ErrorResourceInconsistentResnapNotStarted",e.ErrorResourceInconsistentResnapUrlMissing="ErrorResourceInconsistentResnapUrlMissing",e.ServerErrorFileDownloadResourceInconsistent="ServerErrorFileDownloadResourceInconsistent",e.ServerErrorResourceInconsistentResnaptimeout="ServerErrorResourceInconsistentResnaptimeout",e.ServerErrorResourceInconsistentResnapNotStarted="ServerErrorResourceInconsistentResnapNotStarted",e.ServerErrorResourceInconsistentResnapUrlMissing="ServerErrorResourceInconsistentResnapUrlMissing"}(c||(c={})),function(e){e.ErrorRESERVEDSuccess="ErrorRESERVEDSuccess",e.BadRequest="BadRequest",e.Fatal="Fatal",e.NotSupported="NotSupported",e.Transient="Transient"}(d||(d={}));var f=function e(){_class_call_check(this,e)};f.JsonType="application/json",f.ImagePng="image/png",f.ImageJpg="image/jpg",f.PlainTextType="text/plain";var p,_,y=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"processMultipartResponse",value:function(e,r,t){var n=this;return _async_to_generator((function(){var o,i;return _ts_generator(this,(function(s){if(null==e)throw"multipartContentBuffer is empty";try{o=new TextDecoder("utf-8").decode(e),n.parseMultipart(o,r).forEach((function(e){var r=n.parseResponsePart(e);t(r)}))}catch(e){i={Err:new Error(e)},t(i)}return[2]}))}))()}},{key:"fetchBoundary",value:function(e){var r=e.split("boundary=");if(2===r.length)return r[1];throw"No Boundary"}},{key:"processMultipartBinaryResponse",value:function(e,r,t){var n=this;return _async_to_generator((function(){var o,i,s,a,u,c,d,l,f,p,_,y,h,m,v,g,I,S,b,w,C,P,E,x,O;return _ts_generator(this,(function(A){switch(A.label){case 0:if(!e)throw"multipartContentBufferOrStream is empty";o="",i=void 0,s=0,a=[],u=null,d=_instanceof(e,Uint8Array),A.label=1;case 1:A.trys.push([1,7,,8]),A.label=2;case 2:return d?(c=e,[3,5]):[3,3];case 3:return[4,e.read()];case 4:if(l=A.sent(),f=l.done,p=l.value,f)return[3,6];c=p,A.label=5;case 5:_=!0,y=!1,h=void 0;try{for(m=c[Symbol.iterator]();!(_=(v=m.next()).done);_=!0)g=v.value,I=10===g||13===g,S=10===g&&13===u,b=10===u&&13===g,a.push(g),I||(o+=String.fromCharCode(g)),0===s&&S?"--".concat(r)===o&&(s=1,o="",a=[]):1===s&&b?(i=new Uint8Array(a),s=2,o="",a=[]):2===s&&S?(s=3,o="",a=[]):3===s&&(o.length>r.length+4&&(o=""),"--".concat(r)===o&&(w=a.length-o.length,C=a.slice(0,w-1),s=1,P=n.processHeader(i),E={Headers:P,Body:new Uint8Array(C)},t(E),o="",i=void 0,a=[]),S&&(o="")),u=g}catch(e){y=!0,h=e}finally{try{_||null==m.return||m.return()}finally{if(y)throw h}}return d?[3,6]:[3,2];case 6:return[3,8];case 7:return x=A.sent(),O={Err:new Error(x)},t(O),[3,8];case 8:return[2]}}))}))()}},{key:"parseMultipart",value:function(e,r){var t="--".concat(r);return e.split(t).map((function(e){return e.trim()})).filter((function(e){return""!==e&&"--"!==e}))}},{key:"parseResponsePart",value:function(e){var r=this.parseResponseHeaderFromPart(e).split("\n"),t=new Map;r.forEach((function(e){var r=e.split(": ");2===r.length&&t.set(r[0],r[1])}));var n=this.parseResponseBodyFromPart(e),o=(new TextEncoder).encode(n);return{Headers:t,Body:o}}},{key:"parseResponseBodyFromPart",value:function(e){var r=e.split("\n\r\n");if(2===r.length)return r[1];throw"No response Body"}},{key:"parseResponseHeaderFromPart",value:function(e){var r=e.split("\n\r\n");if(2===r.length)return r[0];throw"No response Headers"}},{key:"processHeader",value:function(e){var r=new Map;if(e){for(var t="",n=0;n<e.byteLength;n+=1)t+=String.fromCharCode(e[n]);t.split("\n").forEach((function(e){var t=e.split(": ");2===t.length&&r.set(t[0],t[1])}))}return r}}]),e}(),h=t(176),m=function(){function e(){_class_call_check(this,e)}return _create_class(e,[{key:"sendTraceTag",value:function(){}},{key:"shipAssertTag",value:function(){}},{key:"debugAssertTag",value:function(){}},{key:"setCorrelationId",value:function(){}}]),e}(),v=new(function(){function e(){_class_call_check(this,e),this.externalLogger=new m}return _create_class(e,[{key:"setCorrelationId",value:function(e){this.externalLogger.setCorrelationId(e)}},{key:"setLogger",value:function(e){this.externalLogger=e}},{key:"sendTraceTag",value:function(e,r,t,n){this.externalLogger.sendTraceTag(e,r,t,n)}},{key:"debugAssertTag",value:function(e,r,t,n){this.externalLogger.debugAssertTag(e,r,t,n)}},{key:"shipAssertTag",value:function(e,r,t,n){this.externalLogger.shipAssertTag(e,r,t,n)}}]),e}());!function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS",e[e.msoulscat_ES_EWAJSGrid=1]="msoulscat_ES_EWAJSGrid",e[e.msoulscat_ES_EWAJSChart=6]="msoulscat_ES_EWAJSChart",e[e.msoulscat_MSOSP_FileMenuCommands=202]="msoulscat_MSOSP_FileMenuCommands",e[e.msoulscat_MSOSP_AddInCommands=220]="msoulscat_MSOSP_AddInCommands",e[e.msoulscat_MSOSP_OTelJS=225]="msoulscat_MSOSP_OTelJS",e[e.msoulscat_MSOSP_OTelJSInWebWoker=227]="msoulscat_MSOSP_OTelJSInWebWoker",e[e.msoulscat_MSOSP_OTelJSWebWorkerPrototype=228]="msoulscat_MSOSP_OTelJSWebWorkerPrototype",e[e.msoulscat_Wac_WordViewer=301]="msoulscat_Wac_WordViewer",e[e.msoulscat_Wac_BrowserGeneral=306]="msoulscat_Wac_BrowserGeneral",e[e.msoulscat_Wac_TaskPane=320]="msoulscat_Wac_TaskPane",e[e.msoulscat_Wac_OneNoteGeneral=339]="msoulscat_Wac_OneNoteGeneral",e[e.msoulscat_Wac_Ribbon=340]="msoulscat_Wac_Ribbon",e[e.msoulscat_Wac_WacFeedback=356]="msoulscat_Wac_WacFeedback",e[e.msoulscat_Wac_WopiPendingApplication=379]="msoulscat_Wac_WopiPendingApplication",e[e.msoulscat_Wac_Telemetry=383]="msoulscat_Wac_Telemetry",e[e.msoulscat_Wac_WacCatchUpActivities=391]="msoulscat_Wac_WacCatchUpActivities",e[e.msoulscat_Wac_Dictation=394]="msoulscat_Wac_Dictation",e[e.msoulscat_Wac_OneNoteSync=395]="msoulscat_Wac_OneNoteSync",e[e.msoulscat_Wac_VisioApp=700]="msoulscat_Wac_VisioApp",e[e.msoulscat_OneNoteOnline_EditableCache=1601]="msoulscat_OneNoteOnline_EditableCache",e[e.msoulscat_Wac_PptAnimation=800]="msoulscat_Wac_PptAnimation",e[e.msoulscat_Wac_PptLive=833]="msoulscat_Wac_PptLive",e[e.msoulscat_Wac_PptMWeb=834]="msoulscat_Wac_PptMWeb",e[e.msoulscat_Wac_PptGc2General=835]="msoulscat_Wac_PptGc2General",e[e.msoulscat_Wac_PptGc2GraphicHost=836]="msoulscat_Wac_PptGc2GraphicHost",e[e.msoulscat_Wac_PptGc2Operation=837]="msoulscat_Wac_PptGc2Operation",e[e.msoulscat_Wac_PptGc2EditCanvas=852]="msoulscat_Wac_PptGc2EditCanvas",e[e.msoulscat_Wac_PptDataSync=844]="msoulscat_Wac_PptDataSync",e[e.msoulscat_Wac_PptFluidRuntime=848]="msoulscat_Wac_PptFluidRuntime",e[e.msoulscat_Wac_PptShape=815]="msoulscat_Wac_PptShape",e[e.msoulscat_Wac_PptSession=817]="msoulscat_Wac_PptSession",e[e.msoulscat_Wac_PptSlideshow=830]="msoulscat_Wac_PptSlideshow",e[e.msoulscat_Wac_PptView=822]="msoulscat_Wac_PptView",e[e.msoulscat_Wac_PptVideos=846]="msoulscat_Wac_PptVideos",e[e.msoulscat_Uci_Insights=1303]="msoulscat_Uci_Insights",e[e.msoulscat_Wac_VersionHistory=2300]="msoulscat_Wac_VersionHistory",e[e.msoulscat_Wac_WordPresence=302]="msoulscat_Wac_WordPresence",e[e.msoulscat_Wac_OAuth=3e3]="msoulscat_Wac_OAuth",e[e.msoulscat_Wac_WordVersionHistory=3005]="msoulscat_Wac_WordVersionHistory",e[e.msoulscat_Wac_LivePersonaCard=3006]="msoulscat_Wac_LivePersonaCard",e[e.msoulscat_Wac_CatchUpFlyout=3012]="msoulscat_Wac_CatchUpFlyout",e[e.msoulscat_Wac_WordDesigner=3016]="msoulscat_Wac_WordDesigner",e[e.msoulscat_Wac_ModernFontPicker=3021]="msoulscat_Wac_ModernFontPicker",e[e.msoulscat_Wac_UnifiedUiHost=3027]="msoulscat_Wac_UnifiedUiHost",e[e.msoulscat_Wac_EquationTools=3033]="msoulscat_Wac_EquationTools",e[e.msoulscat_Osf_Latency=1401]="msoulscat_Osf_Latency",e[e.msoulscat_Osf_Notification=1402]="msoulscat_Osf_Notification",e[e.msoulscat_Osf_Runtime=1403]="msoulscat_Osf_Runtime",e[e.msoulscat_Wac_AiMaker=3041]="msoulscat_Wac_AiMaker",e[e.msoulscat_Wac_AiRewrite=3043]="msoulscat_Wac_AiRewrite",e[e.msoulscat_Wac_AiInsert=3044]="msoulscat_Wac_AiInsert",e[e.msoulscat_Wac_AiSummarize=3047]="msoulscat_Wac_AiSummarize",e[e.msoulscat_Wac_CopilotCompose=3048]="msoulscat_Wac_CopilotCompose",e[e.msoulscat_Wac_Skittles=3049]="msoulscat_Wac_Skittles",e[e.msoulscat_Wac_CopilotChat=3050]="msoulscat_Wac_CopilotChat",e[e.msoulscat_Wac_Syntex=3051]="msoulscat_Wac_Syntex",e[e.msoulscat_Wac_WireGraph=3052]="msoulscat_Wac_WireGraph",e[e.msoulscat_Wac_CshCopilot=3053]="msoulscat_Wac_CshCopilot",e[e.msoulscat_Wac_CopilotProactiveSummary=3055]="msoulscat_Wac_CopilotProactiveSummary",e[e.msoulscat_Wac_CopilotProactiveShared=3056]="msoulscat_Wac_CopilotProactiveShared",e[e.msoulscat_Wac_CopilotCursor=3057]="msoulscat_Wac_CopilotCursor",e[e.msoulscat_Wac_WasmGeneral=3059]="msoulscat_Wac_WasmGeneral",e[e.msoulscat_Wac_WasmTextLayout=3060]="msoulscat_Wac_WasmTextLayout",e[e.msoulscat_Wac_WasmSmartArt=3061]="msoulscat_Wac_WasmSmartArt",e[e.msoulscat_Wac_WasmClient=3062]="msoulscat_Wac_WasmClient",e[e.msoulscat_Wac_WasmNative=3063]="msoulscat_Wac_WasmNative",e[e.msoulscat_AIHub_CreateModuleTelemetry=4e3]="msoulscat_AIHub_CreateModuleTelemetry",e[e.msoulscat_AIHub_CreateModuleAugloop=4001]="msoulscat_AIHub_CreateModuleAugloop",e[e.msoulscat_AIHub_CreateModuleDAS=4002]="msoulscat_AIHub_CreateModuleDAS",e[e.msoulscat_AIHub_CreateModuleConfig=4003]="msoulscat_AIHub_CreateModuleConfig",e[e.msoulscat_AIHub_CreateModuleContext=4004]="msoulscat_AIHub_CreateModuleContext",e[e.msoulscat_AIHub_CreateModuleGraph=4005]="msoulscat_AIHub_CreateModuleGraph",e[e.msoulscat_AIHub_CreateModuleExperiences=4006]="msoulscat_AIHub_CreateModuleExperiences",e[e.msoulscat_AIHub_CreateModuleHttp=4007]="msoulscat_AIHub_CreateModuleHttp",e[e.msoulscat_AIHub_CreateModuleRouting=4008]="msoulscat_AIHub_CreateModuleRouting",e[e.msoulscat_AIHub_CreateModuleStorage=4009]="msoulscat_AIHub_CreateModuleStorage",e[e.msoulscat_AIHub_CreateModuleStore=4010]="msoulscat_AIHub_CreateModuleStore",e[e.msoulscat_AIHub_CreateModuleUI=4011]="msoulscat_AIHub_CreateModuleUI",e[e.msoulscat_AIHub_CreateModuleSharePoint=4012]="msoulscat_AIHub_CreateModuleSharePoint",e[e.msoulscat_AIHub_CreateModuleUI_Artifacts=4100]="msoulscat_AIHub_CreateModuleUI_Artifacts",e[e.msoulscat_AIHub_CreateModuleUI_BrandKit=4101]="msoulscat_AIHub_CreateModuleUI_BrandKit",e[e.msoulscat_AIHub_CreateModuleUI_Forms=4102]="msoulscat_AIHub_CreateModuleUI_Forms",e[e.msoulscat_AIHub_CreateModuleUI_Homepage=4103]="msoulscat_AIHub_CreateModuleUI_Homepage",e[e.msoulscat_AIHub_CreateModuleUI_Text=4104]="msoulscat_AIHub_CreateModuleUI_Text",e[e.msoulscat_AIHub_CreateModuleUI_Video=4105]="msoulscat_AIHub_CreateModuleUI_Video"}(p||(p={})),function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Important=20]="Important",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(_||(_={}));var g=t(227),I=function(){function e(r,t,n,o){_class_call_check(this,e),this.parsedResponse={slideOrder:[],slideAllInfo:[]},this.m_settings=r,this.m_responses=t,this.m_perfDictionary=n,this.m_parsedBasedResponse=o}return _create_class(e,[{key:"parsePart",value:function(r){if(r&&r.Headers){if(this.m_perfDictionary[u.parserCallback]){var t=this.m_perfDictionary[u.parserCallback];t.callCounter=t.callCounter+1,t.lastCallStart=C.performanceNowTrimmed()}else{var n;this.m_perfDictionary[u.parserCallback]=(_define_property(n={},"lastCallStart",C.performanceNowTrimmed()),_define_property(n,"lastCallEnd",C.performanceNowTrimmed()),_define_property(n,"callCounter",0),_define_property(n,"slidesHaveImages",[]),_define_property(n,"slidesHaveImageResources",[]),n)}var o=this.m_perfDictionary[u.parserCallback],i=r.Headers.get(u.ContentDisposition),s=r.Headers.get(u.ContentType);this.m_parsedBasedResponse.usedOutputCache=r.Headers.get(u.XusedOutputCache),this.m_parsedBasedResponse.newSnapUrl=r.Headers.get(u.Xnewsnapurl);var a=r.Headers.get(u.ErrorCode)||c.ErrorRESERVEDSuccess,l=r.Headers.get(u.ErrorCategory)||d.ErrorRESERVEDSuccess,f=r.Headers.get(u.XusedOutputCache);if(i){var y,h=i.indexOf("pres%2fSlideMetadatasldIdx")>0;try{y=decodeURIComponent(i.substring(i.indexOf("name=")+5).trim())}catch(e){v.sendTraceTag(595641600,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::parseMultipartResponse - partResponse Error:".concat(e))}if(y){if(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemUsedOutputCacheMap||(this.m_parsedBasedResponse.itemUsedOutputCacheMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(y,a),this.m_parsedBasedResponse.itemErrorCategoryMap.set(y,l),f&&this.m_parsedBasedResponse.itemUsedOutputCacheMap.set(y,f),a&&a.trim().toLowerCase()===c.ErrorRESERVEDSuccess.toLowerCase())if(i.indexOf("presinfo%2fslimSlideOrder")>0){var m=JSON.parse(new TextDecoder("utf-8").decode(r.Body)),g=!0,I=!1,S=void 0;try{for(var b,w=m[Symbol.iterator]();!(g=(b=w.next()).done);g=!0){var P=b.value;this.parsedResponse.slideOrder.push({sid:P,cid:0})}}catch(e){I=!0,S=e}finally{try{g||null==w.return||w.return()}finally{if(I)throw S}}}else if(i.indexOf("presinfo%2fmetadata")>0){var E=JSON.parse(new TextDecoder("utf-8").decode(r.Body)),x=[],O=!0,A=!1,M=void 0;try{for(var T,k=E.SidSlideOrder[Symbol.iterator]();!(O=(T=k.next()).done);O=!0){var R=T.value;x.push({sid:R,cid:0})}}catch(e){A=!0,M=e}finally{try{O||null==k.return||k.return()}finally{if(A)throw M}}var j=E.SidHiddenSlides?E.SidHiddenSlides.map((function(e){return{sid:e,cid:0}})):void 0,N=E.SlideShowProperties,W={Item:null};N.Item||(W={Item:null}),N.Item.s?W={Item:{sid:N.Item.s}}:N.Item.st&&(W={Item:{start:N.Item.st,end:N.Item.end}});var U={SlideOrder:x,HiddenSlideOrder:j,SlideEmuWidth:E.SlideEmuWidth,SlideEmuHeight:E.SlideEmuHeight,ViewScalingFactor:E.ViewScalingFactor,SlideShowProperties:W,Sections:E.Sections};this.parsedResponse.slideAllInfo.push(U)}else if((i.indexOf("pres%2fsldSid")>0||i.indexOf("pres%2fsldIdx")>0)&&s&&e.getSupportedImageType(s)){for(var D=e.getSlideKeyFromHeader(i,i.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),F="",H=0;H<r.Body.length;H+=1)F+=String.fromCharCode(r.Body[H]);var L="data:".concat(e.getSupportedImageType(s),";base64, ").concat(btoa(F));o.slidesHaveImages.push(D),this.m_responses[D]||(this.m_responses[D]={ID:{sid:D,cid:0}}),this.m_responses[D].SlideImageData=L}else if((i.indexOf("pres%2fsldSid")>0||i.indexOf("pres%2fsldIdx")>0)&&s&&-1!==s.indexOf("application/json")){var J=e.getSlideKeyFromHeader(i,i.indexOf("pres%2fsldSid")>0?"sldSid":"sldIdx"),q=JSON.parse(new TextDecoder("utf-8").decode(r.Body));q.mediaUrls?(this.m_responses[J]||(this.m_responses[J]={ID:{sid:q.slideShowInfo.sld[0].id,cid:0}}),this.m_responses[J].SlideShowInfo=q.slideShowInfo,this.m_responses[J].MediaUrls=q.mediaUrls):(this.m_responses[J]||(this.m_responses[J]={ID:{sid:q.sld[0].id,cid:0}}),this.m_responses[J].SlideShowInfo=q)}else if(i.indexOf("pres%2fNotesSldSid")>0||i.indexOf("pres%2fNotesSldIdx")>0){var B=e.getSlideKeyFromHeader(i,i.indexOf("pres%2fNotesSldSid")>0?"NotesSldSid":"NotesSldIdx"),G=new TextDecoder("utf-8").decode(r.Body);this.m_responses[B]||(this.m_responses[B]={ID:{sid:B,cid:0}}),this.m_responses[B].NoteHtml=G}else if(i.indexOf("pres%2fCommentsSldSid")>0||i.indexOf("pres%2fCommentsSldIdx")>0){var z=e.getSlideKeyFromHeader(i,i.indexOf("pres%2fCommentsSldSid")>0?"CommentsSldSid":"CommentsSldIdx"),V=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[z]||(this.m_responses[z]={ID:{sid:z,cid:0}}),this.m_responses[z].Comments=V}else if(i.indexOf("pres%2fSlideMetadataSldSid")>0||h){var K=e.getSlideKeyFromHeader(i,i.indexOf("pres%2fSlideMetadataSldSid")>0?"SlideMetadataSldSid":"SlideMetadatasldIdx"),X=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[K]||(this.m_responses[K]={ID:X.ID}),this.m_responses[K].Title=X.Title,this.m_responses[K].HasAnimation=X.HasAnimation,this.m_responses[K].Hidden=X.Hidden,this.m_responses[K].HasTransition=X.HasTransition}else if(i.indexOf("pres%2fSlideAccessibilityModelSldSid")>0||i.indexOf("pres%2fSlideAccessibilityModelSldIdx")>0){var $=e.getSlideKeyFromHeader(i,i.indexOf("pres%2fSlideAccessibilityModelSldSid")>0?"SlideAccessibilityModelSldSid":"SlideAccessibilityModelSldIdx"),Y=JSON.parse(new TextDecoder("utf-8").decode(r.Body));this.m_responses[$]||(this.m_responses[$]={ID:Y.ID}),this.m_responses[$].AccessibilityModel=Y.AccessibilityModel}else if(i.indexOf("Res%2fSldSid")>0&&s&&e.getSupportedImageType(s)){var Q=e.extractStringInBetweenStrings(i,"Res%2fSldSid","%2f"),Z=e.extractStringInBetweenStrings(i,"filename=","\r");if(Q&&Z){var ee,re,te={sid:+Q,cid:0},ne=e.getSupportedImageType(s);if(r.Body)if(this.m_settings.allowImagesAsBinary)ee={Id:Z,Base64:"",Binary:r.Body,MimeType:ne,ByteCount:r.Body.length};else{for(var oe="",ie=0;ie<r.Body.length;ie+=1)oe+=String.fromCharCode(r.Body[ie]);var se="data:".concat(ne,";base64,").concat(btoa(oe));ee={Id:Z,Base64:se,MimeType:ne,ByteCount:se.length}}else v.sendTraceTag(508420494,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::parseMultipartResponse - Body is undefined. slideId:".concat(Q,", resourceId:").concat(Z)),ee={Id:Z,Base64:"",MimeType:ne,ByteCount:0};o.slidesHaveImageResources.push(te.sid);var ae=!0,ue=!1,ce=void 0;try{for(var de,le=Object.entries(this.m_responses)[Symbol.iterator]();!(ae=(de=le.next()).done);ae=!0){var fe=_sliced_to_array(de.value,2)[1];fe.ID&&fe.ID.sid===te.sid&&(re=fe)}}catch(e){ue=!0,ce=e}finally{try{ae||null==le.return||le.return()}finally{if(ue)throw ce}}re?re.ResourceData?re.ResourceData.push(ee):re.ResourceData=[ee]:this.m_responses[te.sid]={ID:te,ResourceData:[ee]}}else v.sendTraceTag(595628568,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::parseMultipartResponse - Cannot get slideId or resourceId from header. slideId:".concat(Q,", resourceId:").concat(Z)),this.m_parsedBasedResponse.responseErrorCode=c.ErrorResponseNotValid}}else this.m_parsedBasedResponse.responseErrorCode=c.ErrorItemNameNotValid}else r.Headers.get("x-ms-content-id")&&(this.m_parsedBasedResponse.itemErrorCodeMap||(this.m_parsedBasedResponse.itemErrorCodeMap=new Map),this.m_parsedBasedResponse.itemErrorCategoryMap||(this.m_parsedBasedResponse.itemErrorCategoryMap=new Map),this.m_parsedBasedResponse.itemErrorCodeMap.set(r.Headers.get("x-ms-content-id"),a),this.m_parsedBasedResponse.itemErrorCategoryMap.set(r.Headers.get("x-ms-content-id"),l)),this.m_parsedBasedResponse.responseErrorCode=c.ErrorContentDispositionHeaderNotValid;o.lastCallEnd=C.performanceNowTrimmed()}else this.m_parsedBasedResponse.responseErrorCode=c.ErrorResponseNotValid;r.Err&&(this.m_parsedBasedResponse.responseErrorCode=c.ErrorResponseNotValid,v.sendTraceTag(595687003,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::parseMultipartResponse - partResponse Error:".concat(r.Err)))}}],[{key:"getSupportedImageType",value:function(e){return C.s_supportedImageType.find((function(r){return-1!==e.indexOf(r)}))||""}},{key:"getSlideKeyFromHeader",value:function(e,r){var t=new RegExp(".*".concat(r,"(.*)"));if(!e)return v.sendTraceTag(508420493,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::getSlideLocationFromHeader - header is null."),-1;var n=t.exec(e);return null!=n&&n.length>=2?+n[1]:(v.sendTraceTag(508420492,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::getSlideLocationFromHeader - regex result is null header:".concat(e,", itemId: ").concat(r)),-1)}},{key:"extractStringInBetweenStrings",value:function(e,r,t){var n=e.indexOf(r)+r.length,o=t?e.indexOf(t,n):-1;return-1===o?e.substring(n):e.substring(n,o)}}]),e}(),S=function(){function e(){_class_call_check(this,e)}return _create_class(e,null,[{key:"load",value:function(r){for(var t in r)e.m_settings[t]=r[t]}},{key:"readBooleanOrDefault",value:function(r,t){var n=void 0===e.m_settings?"":_type_of(e.m_settings[r]);return"string"===n?"true"===e.m_settings[r].toLowerCase():"boolean"===n?e.m_settings[r]:t}},{key:"readNumberOrDefault",value:function(r,t){var n=void 0===e.m_settings?"":_type_of(e.m_settings[r]);return"string"===n||"number"===n?Number(e.m_settings[r]):t}},{key:"readStringOrDefault",value:function(r,t){return void 0===e.m_settings||"string"!=typeof e.m_settings[r]?t:e.m_settings[r]}},{key:"addOrUpdateSettingsFromUrl",value:function(r,t){var n=t.get("wdset");if(!n)return r;var o=!0,i=!1,s=void 0;try{for(var a,u=n.split(",")[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value.split(":"),d=c[0].split("."),l=d[0],f=d[1],p=c[1];f&&p&&e.addOrUpdateSetting(r,l,f,p)}}catch(e){i=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw s}}return r}},{key:"addOrUpdateSetting",value:function(e,r,t,n){"__proto__"!==r&&(e[r]||(e[r]={}),e[r][t]=n)}}]),e}();S.m_settings={};var b={};function w(e){e.logger&&v.setLogger(e.logger),e.settings&&S.load(e.settings?e.settings.podsproxy:{}),e.disabledChangeGates&&h.ChangeGate.initSettings({disabledChangeGates:e.disabledChangeGates||""}),e.exposed&&(e.exposed.svm=b)}var C=function(){function e(r,t,n,o,i,s,a){var u=this;if(_class_call_check(this,e),this.events=new g.EventEmitter,this.m_requestHeaders=new Headers,this.m_itemsList=new Array,this.m_multipartParser=new y,v.setLogger(o),v.sendTraceTag(508420489,p.msoulscat_Wac_PptSession,r&&t&&t.DownloadUrl&&n&&t.DocID?_.Info:_.Warning,"PodsProxy::constructor - podsUrl:".concat(r,", fileExtension:").concat(n,", docId:").concat(t.DocID,"}")),v.sendTraceTag(508420488,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::constructor - presentUrl:".concat(i,"}")),this.m_podsUrl=r,this.m_presentUrl=i,this.m_downloadUrl=t.DownloadUrl,this.m_settings=a||{timeout:3e4,throwHttpErrors:!0},h.ChangeGate.initSettings({disabledChangeGates:this.m_settings.disabledChangeGates||""}),this.m_wacFallbackDownloadUrl=a?a.wacFallbackDownloadUrl:void 0,s&&s.forEach((function(e,r){u.m_requestHeaders.append(r,e)})),this.m_getPresInfoRequest={Source:t,FileExtension:n||"pptx"},this.m_getItemsRequest={Source:t,FileExtension:n||"pptx",Items:this.m_itemsList},this.m_imageInputProperties={ClientColorSettings:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientWidth:void 0,ClientHeight:void 0,MinClientWidth:void 0,MinClientHeight:void 0,MaxClientWidth:void 0,MaxClientHeight:void 0,TranslateLanguage:void 0},this.m_imageOptions={InputProperties:this.m_imageInputProperties},this.m_slideInfoInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideInfoOptions={InputProperties:this.m_slideInfoInputProperties},this.m_slideResourceInputProperties={ClientWidth:void 0,ClientHeight:void 0,IsHighContrast:void 0,ColorMode:void 0,ClientColorSettings:void 0,TranslateLanguage:void 0,LocaleName:void 0},this.m_slideResourceOptions={InputProperties:this.m_slideResourceInputProperties,Filters:{EnableClustering:!1}},this.m_slideAccessibilityInputProperties={TranslateLanguage:void 0,LocaleName:void 0},this.m_slideAccessibilityOptions={InputProperties:this.m_slideAccessibilityInputProperties},this.m_presInfoFilters={RenderSlideShowProperties:!0,FilterHiddenSlideInfo:!1,IncludeSections:!1},this.m_presInfoInputProperties={IsHighContrast:!1,ClientColorSettings:""},this.m_presInfoOptions={Filters:this.m_presInfoFilters,InputProperties:this.m_presInfoInputProperties},this.m_errorMap=new Map,this.setErrorMap(),a&&a.perfTimingMonitorEnabled)try{var c=new Set;this.m_presentUrl&&(c.add("".concat(this.m_presentUrl,"/items")),c.add("".concat(this.m_presentUrl,"/ping"))),c.add("getitems.ashx"),c.add("getmedia.ashx"),c.add("remoteuls.ashx"),c.add("podhandler.ashx"),c.add("remotetelemetry.ashx"),new PerformanceObserver((function(r){return e.logPerformanceEntries(r,c)})).observe({entryTypes:["resource"]})}catch(e){v.sendTraceTag(508420487,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:PerformanceObserver failed with exception ".concat(e))}}return _create_class(e,[{key:"getSlideOrderAsync",value:function(){var e=this;return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return[4,e.getPresInfoAsync("getSlideOrderAsync")];case 1:return[4,t.sent().json()];case 2:return r=t.sent(),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:d.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:r.SlideOrder}]}}))}))()}},{key:"getSlideInfosAsync",value:function(e){var r=this;return _async_to_generator((function(){var t;return _ts_generator(this,(function(n){switch(n.label){case 0:return e.RenderOptions&&(r.m_getPresInfoRequest.SlideRanges=[{IDs:e.SlideLocations.map((function(e){return e.slideId})),RenderOptions:e.RenderOptions}]),r.m_getPresInfoRequest.ClientWidth=e.ClientWidth?e.ClientWidth:r.m_getPresInfoRequest.ClientWidth,r.m_getPresInfoRequest.ClientHeight=e.ClientHeight?e.ClientHeight:r.m_getPresInfoRequest.ClientHeight,r.m_getPresInfoRequest.DevicePixelRatio=e.DevicePixelRatio?e.DevicePixelRatio:r.m_getPresInfoRequest.DevicePixelRatio,r.m_getPresInfoRequest.IsHighContrast=e.IsHighContrast?e.IsHighContrast:r.m_getPresInfoRequest.IsHighContrast,r.m_getPresInfoRequest.ClientColorSettings=e.ClientColorSettings?e.ClientColorSettings:r.m_getPresInfoRequest.ClientColorSettings,r.m_getPresInfoRequest.MinClientWidth=e.MinClientWidth?e.MinClientWidth:r.m_getPresInfoRequest.MinClientWidth,r.m_getPresInfoRequest.MinClientHeight=e.MinClientHeight?e.MinClientHeight:r.m_getPresInfoRequest.MinClientHeight,r.m_getPresInfoRequest.MaxClientWidth=e.MaxClientWidth?e.MaxClientWidth:r.m_getPresInfoRequest.MaxClientWidth,r.m_getPresInfoRequest.MaxClientHeight=e.MaxClientHeight?e.MaxClientHeight:r.m_getPresInfoRequest.MaxClientHeight,[4,r.getPresInfoAsync("getSlideInfosAsync")];case 1:return[4,n.sent().json()];case 2:return t=n.sent(),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:d.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:t.Slides}]}}))}))()}},{key:"getItemsSlideOrderAsync",value:function(){var e=this;return _async_to_generator((function(){var r,t;return _ts_generator(this,(function(n){switch(n.label){case 0:return e.m_itemsList=new Array,e.m_itemsList.push({Id:l.PresinfoslimSlideOrder,AcceptTypes:[f.JsonType]}),e.m_getItemsRequest.Items=e.m_itemsList,[4,e.getItemsAsync("getItemsSlideOrderAsync")];case 1:return r=n.sent(),t={},[4,e.createSlideIdResponse(e.parseMultipartResponseAsync(r,t))];case 2:return[2,n.sent()]}}))}))()}},{key:"getItemsPresInfoAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,i,s,a,c,d,p,_;return _ts_generator(this,(function(y){switch(y.label){case 0:return t.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:t.m_presInfoInputProperties.ClientHeight,t.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:t.m_presInfoInputProperties.ClientWidth,t.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:t.m_presInfoInputProperties.IsHighContrast,t.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:t.m_presInfoInputProperties.ClientColorSettings,t.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:t.m_presInfoFilters.FilterHiddenSlideInfo,t.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:t.m_presInfoFilters.IncludeSections,t.m_itemsList=new Array,t.m_itemsList.push({Id:l.PresInfoMetaData,AcceptTypes:[f.JsonType],Options:JSON.stringify(t.m_presInfoOptions)}),t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(u.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(u.XCorrelationId,r.CorrelationId||""),n=_object_spread_props(_object_spread({},r.RequestInfo,t.m_settings.sessionInfo),_define_property({},"CorrelationId",r.CorrelationId)),t.m_requestHeaders.set(u.RequestInfo,JSON.stringify(n)),o=t.objectDictionaryToRequestIdString(n),t.m_requestHeaders.set(u.clientRequestIdHeader,o),t.m_requestHeaders.set(u.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),t.m_requestHeaders.set(u.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),_define_property(s={},"action","getItemsPresInfoAsync"),_define_property(s,"correlationId",r.CorrelationId),_define_property(s,"server",(_define_property(i={},"start",e.performanceNowTrimmed()),_define_property(i,"end",e.performanceNowTrimmed()),i)),a=s,e.logPerf(a),[4,t.getItemsAsync("getItemsPresInfoAsync")];case 1:return c=y.sent(),a[u.server].end=e.performanceNowTrimmed(),c&&c.response&&c.response.headers&&(a[u.contentLength]=c.response.headers.get(u.ContentLength)),e.logPerf(a),a[u.parser]=(_define_property(d={},"start",e.performanceNowTrimmed()),_define_property(d,"end",e.performanceNowTrimmed()),d),p=t.setTimeoutForParsingResponse(a),[4,t.createPresInfoResponse(t.parseMultipartResponseAsync(c,a))];case 2:return _=y.sent(),clearTimeout(p),a[u.parser].end=e.performanceNowTrimmed(),a[u.usedOutputCache]=!!_.usedOutputCache&&"true"===_.usedOutputCache.trim().toLowerCase(),a[u.itemUsedOutputCacheMap]=!!_.itemUsedOutputCacheMap&&Array.from(_.itemUsedOutputCacheMap.entries()),e.logPerf(a),_.metadata=t.generateReportPerfDictionary(a),[2,_]}}))}))()}},{key:"getItemsPresInfoAndSlideInfosAsync",value:function(r,t,i){var s=this;return _async_to_generator((function(){var a,y,h,m,g,I,S,b,w,C,P,E,x,O,A,M,T,k,R;return _ts_generator(this,(function(j){switch(j.label){case 0:a=_define_property({},"action","getItemsPresInfoAndSlideInfoAsync"),y=null,j.label=1;case 1:for(j.trys.push([1,4,,5]),s.m_presInfoOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:s.m_presInfoInputProperties.ClientHeight,s.m_presInfoOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:s.m_presInfoInputProperties.ClientWidth,s.m_presInfoOptions.InputProperties.IsHighContrast=r.IsHighContrast?r.IsHighContrast:s.m_presInfoInputProperties.IsHighContrast,s.m_presInfoOptions.InputProperties.ClientColorSettings=r.ClientColorSettings?r.ClientColorSettings:s.m_presInfoInputProperties.ClientColorSettings,s.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==r.FilterHiddenSlideInfo?r.FilterHiddenSlideInfo:s.m_presInfoFilters.FilterHiddenSlideInfo,s.m_presInfoOptions.Filters.IncludeSections=void 0!==r.IncludeSections?r.IncludeSections:s.m_presInfoFilters.IncludeSections,s.m_itemsList=new Array,s.m_itemsList.push({Id:l.PresInfoMetaData,AcceptTypes:[f.JsonType],Options:JSON.stringify(s.m_presInfoOptions)}),s.m_imageOptions.InputProperties.ClientWidth=t.ClientWidth?t.ClientWidth:s.m_imageInputProperties.ClientWidth,s.m_imageOptions.InputProperties.ClientHeight=t.ClientHeight?t.ClientHeight:s.m_imageInputProperties.ClientHeight,s.m_imageOptions.InputProperties.IsHighContrast=t.IsHighContrast?t.IsHighContrast:s.m_imageInputProperties.IsHighContrast,s.m_imageOptions.InputProperties.ClientColorSettings=t.ClientColorSettings?t.ClientColorSettings:s.m_imageInputProperties.ClientColorSettings,s.m_imageOptions.InputProperties.MinClientWidth=t.MinClientWidth?t.MinClientWidth:s.m_imageInputProperties.MinClientWidth,s.m_imageOptions.InputProperties.MinClientHeight=t.MinClientHeight?t.MinClientHeight:s.m_imageInputProperties.MinClientHeight,s.m_imageOptions.InputProperties.MaxClientWidth=t.MaxClientWidth?t.MaxClientWidth:s.m_imageInputProperties.MaxClientWidth,s.m_imageOptions.InputProperties.MaxClientHeight=t.MaxClientHeight?t.MaxClientHeight:s.m_imageInputProperties.MaxClientHeight,s.m_imageOptions.InputProperties.TranslateLanguage=null!=t.TranslateLanguage?t.TranslateLanguage:s.m_imageInputProperties.TranslateLanguage,h=0;h<t.SlideLocations.length;h+=1)t.GetSlideImage?s.m_itemsList.push({Id:t.SlideLocations[h].slideId?l.slideInfoSid+t.SlideLocations[h].slideId.sid.toString():l.slideInfoIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:e.s_supportedImageType,Options:JSON.stringify(s.m_imageOptions)}):t.Filters&&(s.m_slideInfoOptions.InputProperties={ClientWidth:t.ClientWidth?t.ClientWidth:s.m_slideInfoInputProperties.ClientWidth,ClientHeight:t.ClientHeight?t.ClientHeight:s.m_slideInfoInputProperties.ClientHeight,IsHighContrast:t.IsHighContrast?t.IsHighContrast:s.m_slideInfoInputProperties.IsHighContrast,ColorMode:t.ColorMode?t.ColorMode:s.m_slideInfoInputProperties.ColorMode,ClientColorSettings:t.ClientColorSettings?t.ClientColorSettings:s.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:s.m_slideInfoInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:s.m_slideInfoInputProperties.LocaleName},s.m_slideInfoOptions.Filters=e.ensureISlideInfoFilters(t.Filters),s.m_itemsList.push({Id:t.SlideLocations[h].slideId?l.slideInfoSid+t.SlideLocations[h].slideId.sid.toString():l.slideInfoIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:JSON.stringify(s.m_slideInfoOptions)})),s.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=t.TranslateLanguage?t.TranslateLanguage:s.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:t.LocaleName?t.LocaleName:s.m_slideInfoInputProperties.LocaleName},void 0!==t.GetSlideAccessibilityModelData&&t.GetSlideAccessibilityModelData&&s.m_itemsList.push({Id:t.SlideLocations[h].slideId?l.slideAccessibilityModelSid+t.SlideLocations[h].slideId.sid.toString():l.slideAccessibilityModelIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:JSON.stringify(s.m_slideAccessibilityOptions)}),t.GetSlideNotes&&s.m_itemsList.push({Id:t.SlideLocations[h].slideId?l.slideNotesSid+t.SlideLocations[h].slideId.sid.toString():l.slideCommentsIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:[f.PlainTextType],Options:JSON.stringify(s.m_slideInfoOptions)}),t.GetSlideComments&&s.m_itemsList.push({Id:t.SlideLocations[h].slideId?l.slideCommentsSid+t.SlideLocations[h].slideId.sid.toString():l.slideCommentsIndex+t.SlideLocations[h].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:t.CommentOptions});return s.m_getItemsRequest.Items=s.m_itemsList,s.m_requestHeaders.set(u.CallerCorrelationId,r.CorrelationId||""),s.m_requestHeaders.set(u.XCorrelationId,r.CorrelationId||""),m=_object_spread_props(_object_spread({},r.RequestInfo,s.m_settings.sessionInfo),_define_property({},"CorrelationId",r.CorrelationId)),s.m_requestHeaders.set(u.RequestInfo,JSON.stringify(m)),g=s.objectDictionaryToRequestIdString(m),s.m_requestHeaders.set(u.clientRequestIdHeader,g),s.m_requestHeaders.set(u.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),s.m_requestHeaders.set(u.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),a.correlationId=r.CorrelationId,a[u.server]=(_define_property(I={},"start",e.performanceNowTrimmed()),_define_property(I,"end",e.performanceNowTrimmed()),I),e.logPerf(a),s.events.emit("requestStageChanged",{requestType:n.getItemsPresInfoAndSlideInfoAsync,stageInfo:o.GetItemsCall}),[4,s.getItemsAsync("getItemsPresInfoAndSlideInfoAsync",{overrideGetItemsTimeoutMs:i&&i.overrideGetItemsTimeoutMs})];case 2:if(S=j.sent(),s.m_settings.shouldUpdateNewFileUrlFromSnap&&S.errorCode===c.ServerErrorFileDownloadResourceInconsistent)return[2,{presInfo:void 0,slideInfo:[],responseErrorCode:c.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:S.errorCategory,responseIsIntentional:S.isIntentional,itemErrorCodeMap:void 0}];if(a[u.server].end=e.performanceNowTrimmed(),S&&S.response&&S.response.headers&&(a[u.contentLength]=S.response.headers.get(u.ContentLength),a[u.ContenEncoding]=S.response.headers.get(u.ContenEncoding),a[u.TransferEncoding]=S.response.headers.get(u.TransferEncoding),b=S.response.headers.keys())){w=[],C=!0,P=!1,E=void 0;try{for(x=b[Symbol.iterator]();!(C=(O=x.next()).done);C=!0)A=O.value,w.push(A)}catch(e){P=!0,E=e}finally{try{C||null==x.return||x.return()}finally{if(P)throw E}}a[u.ResponseHeaders]=w}return e.logPerf(a),a[u.parser]=(_define_property(M={},"start",e.performanceNowTrimmed()),_define_property(M,"end",e.performanceNowTrimmed()),M),y=s.setTimeoutForParsingResponse(a),[4,s.parseMultipartResponseAsync(S,a,{shouldTimeoutResponseStreamDownload:i&&i.shouldTimeoutResponseStreamDownload,overrideDownloadTimeoutMs:i&&i.overrideDownloadTimeoutMs,requestType:n.getItemsPresInfoAndSlideInfoAsync})];case 3:return(T=j.sent())&&T.responseErrorCode===c.ErrorDownloadResponseStreamTimeout?[2,{presInfo:void 0,slideInfo:[],responseErrorCode:c.ErrorDownloadResponseStreamTimeout,responseErrorCategory:d.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0}]:(k=s.createPresInfoAndSlideInfoResponse(T,a),null!==y&&(clearTimeout(y),y=null),a[u.parser].end=e.performanceNowTrimmed(),a[u.usedOutputCache]=!!k.usedOutputCache&&"true"===k.usedOutputCache.trim().toLowerCase(),a[u.itemUsedOutputCacheMap]=!!k.itemUsedOutputCacheMap&&Array.from(k.itemUsedOutputCacheMap.entries()),a[u.podsProxyCallSuceeded]=!0,e.logPerf(a),k.metadata=s.generateReportPerfDictionary(a),[2,k]);case 4:return R=j.sent(),v.sendTraceTag(508420486,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getItemsPresInfoAndSlideInfosAsync - exception happened: ".concat(R)),a[u.podsProxyCallSuceeded]=!1,e.logPerf(a),null!==y&&(clearTimeout(y),y=null),[2,{presInfo:void 0,slideInfo:[],responseErrorCode:c.ErrorRESERVEDItemFailed,responseErrorCategory:d.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0}];case 5:return[2]}}))}))()}},{key:"getItemsSlideInfosAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,i,s,a,y,h,m,g,I,S,b,w,C,P;return _ts_generator(this,(function(E){switch(E.label){case 0:n=_define_property({},"action","getItemsSlideInfosAsync"),E.label=1;case 1:for(E.trys.push([1,7,,8]),t.m_imageOptions.InputProperties.ClientWidth=r.ClientWidth?r.ClientWidth:t.m_imageInputProperties.ClientWidth,t.m_imageOptions.InputProperties.ClientHeight=r.ClientHeight?r.ClientHeight:t.m_imageInputProperties.ClientHeight,t.m_imageOptions.InputProperties.IsHighContrast=null!=r.IsHighContrast?r.IsHighContrast:t.m_imageInputProperties.IsHighContrast,t.m_imageOptions.InputProperties.ColorMode=null!=r.ColorMode?r.ColorMode:t.m_imageInputProperties.ColorMode,t.m_imageOptions.InputProperties.ClientColorSettings=null!=r.ClientColorSettings?r.ClientColorSettings:t.m_imageInputProperties.ClientColorSettings,t.m_imageOptions.InputProperties.MinClientWidth=r.MinClientWidth?r.MinClientWidth:t.m_imageInputProperties.MinClientWidth,t.m_imageOptions.InputProperties.MinClientHeight=r.MinClientHeight?r.MinClientHeight:t.m_imageInputProperties.MinClientHeight,t.m_imageOptions.InputProperties.MaxClientWidth=r.MaxClientWidth?r.MaxClientWidth:t.m_imageInputProperties.MaxClientWidth,t.m_imageOptions.InputProperties.MaxClientHeight=r.MaxClientHeight?r.MaxClientHeight:t.m_imageInputProperties.MaxClientHeight,t.m_imageOptions.InputProperties.TranslateLanguage=null!=r.TranslateLanguage?r.TranslateLanguage:t.m_imageInputProperties.TranslateLanguage,t.m_itemsList=new Array,o=0;o<r.SlideLocations.length;o+=1)r.GetSlideImage?t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideInfoSid+r.SlideLocations[o].slideId.sid.toString():l.slideInfoIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:e.s_supportedImageType,Options:JSON.stringify(t.m_imageOptions)}):r.Filters&&(t.m_slideInfoOptions.InputProperties={ClientWidth:r.ClientWidth?r.ClientWidth:t.m_slideInfoInputProperties.ClientWidth,ClientHeight:r.ClientHeight?r.ClientHeight:t.m_slideInfoInputProperties.ClientHeight,IsHighContrast:r.IsHighContrast?r.IsHighContrast:t.m_slideInfoInputProperties.IsHighContrast,ColorMode:r.ColorMode?r.ColorMode:t.m_slideInfoInputProperties.ColorMode,ClientColorSettings:r.ClientColorSettings?r.ClientColorSettings:t.m_slideInfoInputProperties.ClientColorSettings,TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideInfoInputProperties.TranslateLanguage,LocaleName:null!=r.LocaleName?r.LocaleName:t.m_slideInfoInputProperties.LocaleName},t.m_slideInfoOptions.Filters=e.ensureISlideInfoFilters(r.Filters),r.SkipGetSlideInfo||t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideInfoSid+r.SlideLocations[o].slideId.sid.toString():l.slideInfoIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:JSON.stringify(t.m_slideInfoOptions)})),t.m_slideAccessibilityOptions.InputProperties={TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideAccessibilityInputProperties.TranslateLanguage,LocaleName:r.LocaleName?r.LocaleName:t.m_slideInfoInputProperties.LocaleName},void 0!==r.GetSlideAccessibilityModelData&&r.GetSlideAccessibilityModelData&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideAccessibilityModelSid+r.SlideLocations[o].slideId.sid.toString():l.slideAccessibilityModelIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:JSON.stringify(t.m_slideAccessibilityOptions)}),r.GetSlideNotes&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideNotesSid+r.SlideLocations[o].slideId.sid.toString():l.slideCommentsIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[f.PlainTextType],Options:JSON.stringify(t.m_slideInfoOptions)}),r.GetSlideComments&&t.m_itemsList.push({Id:r.SlideLocations[o].slideId?l.slideCommentsSid+r.SlideLocations[o].slideId.sid.toString():l.slideCommentsIndex+r.SlideLocations[o].slideIndex.toString(),AcceptTypes:[f.JsonType],Options:r.CommentOptions});return 0===t.m_itemsList.length?(v.sendTraceTag(508420485,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getItemsSlideInfosAsync - invalid request item list"),[2,{itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRequestFailed,responseErrorCategory:d.BadRequest,responseIsIntentional:!1,slideInfo:[]}]):(t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(u.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(u.XCorrelationId,r.CorrelationId||""),i=_object_spread_props(_object_spread({},r.RequestInfo,t.m_settings.sessionInfo),_define_property({},"CorrelationId",r.CorrelationId)),t.m_requestHeaders.set(u.RequestInfo,JSON.stringify(i)),s=t.objectDictionaryToRequestIdString(i),t.m_requestHeaders.set(u.clientRequestIdHeader,s),t.m_requestHeaders.set(u.PriorityHint,r.PriorityHint?r.PriorityHint.toString():""),t.m_requestHeaders.set(u.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),_define_property(a={},"start",e.performanceNowTrimmed()),_define_property(a,"end",e.performanceNowTrimmed()),y=a,_define_property(h={},"action","getItemsSlideInfosAsync"),_define_property(h,"correlationId",r.CorrelationId),_define_property(h,"server",y),m=h,e.logPerf(m),t.m_settings.shouldFixSlideDataOrder?(r.GetSlideComments&&(I={isGetSlideCommentsRequest:!0}),[4,t.getItemsAsync("getItemsSlideInfosAsync",I)]):[3,3]);case 2:return g=E.sent(),[3,5];case 3:return[4,t.getItemsAsync("getItemsSlideInfosAsync")];case 4:g=E.sent(),E.label=5;case 5:return t.m_settings.shouldUpdateNewFileUrlFromSnap&&g.errorCode===c.ServerErrorFileDownloadResourceInconsistent?[2,{slideInfo:[],responseErrorCode:c.ServerErrorFileDownloadResourceInconsistent,responseErrorCategory:g.errorCategory,responseIsIntentional:!!g.response.headers.get(u.IsIntentional)&&g.response.headers.get(u.IsIntentional),itemErrorCodeMap:void 0}]:(y.end=e.performanceNowTrimmed(),g&&g.response&&g.response.headers&&(m[u.contentLength]=g.response.headers.get(u.ContentLength)),_define_property(S={},"start",e.performanceNowTrimmed()),_define_property(S,"end",e.performanceNowTrimmed()),b=S,m[u.parser]=b,e.logPerf(m),w=t.setTimeoutForParsingResponse(m),[4,t.createSlideInfoResponse(t.parseMultipartResponseAsync(g,m),m)]);case 6:return C=E.sent(),clearTimeout(w),b.end=e.performanceNowTrimmed(),m[u.usedOutputCache]=!!C.usedOutputCache&&"true"===C.usedOutputCache.trim().toLowerCase(),m[u.itemUsedOutputCacheMap]=!!C.itemUsedOutputCacheMap&&Array.from(C.itemUsedOutputCacheMap.entries()),m[u.podsProxyCallSuceeded]=!0,e.logPerf(m),C.metadata=t.generateReportPerfDictionary(m),[2,C];case 7:return P=E.sent(),v.sendTraceTag(508420484,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getItemsSlideInfosAsync - exception happened: ".concat(P)),n[u.podsProxyCallSuceeded]=!1,e.logPerf(n),[2,{slideInfo:[],responseErrorCode:c.ErrorRESERVEDItemFailed,responseErrorCategory:d.Transient,responseIsIntentional:!1,itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0}];case 8:return[2]}}))}))()}},{key:"getItemsResourceAsync",value:function(r){var t=this;return _async_to_generator((function(){var n,o,i,s,a,c,d,l,p,_,y,h,m,v,g;return _ts_generator(this,(function(I){switch(I.label){case 0:t.m_slideResourceOptions.InputProperties={ClientWidth:r.ClientWidth?r.ClientWidth:t.m_slideResourceInputProperties.ClientWidth,ClientHeight:r.ClientHeight?r.ClientHeight:t.m_slideResourceInputProperties.ClientHeight,IsHighContrast:r.IsHighContrast?r.IsHighContrast:t.m_slideResourceInputProperties.IsHighContrast,ColorMode:r.ColorMode?r.ColorMode:t.m_slideResourceInputProperties.ColorMode,ClientColorSettings:r.ClientColorSettings?r.ClientColorSettings:t.m_slideResourceInputProperties.ClientColorSettings,TranslateLanguage:null!=r.TranslateLanguage?r.TranslateLanguage:t.m_slideResourceInputProperties.TranslateLanguage,LocaleName:null!=r.LocaleName?r.LocaleName:t.m_slideResourceInputProperties.LocaleName},t.m_slideResourceOptions.Filters.EnableClustering=void 0!==r.EnableClustering&&r.EnableClustering,t.m_itemsList=new Array,n=!0,o=!1,i=void 0;try{for(s=r.ResourceParams[Symbol.iterator]();!(n=(a=s.next()).done);n=!0){switch(c=a.value,t.m_slideResourceOptions.InputProperties.ResourceId=c.Id,d=String(c.Name.match("[^.]+$")),l="",d){case"jpg":l=f.ImageJpg;break;case"png":l=f.ImagePng}t.m_itemsList.push({Id:c.Name,AcceptTypes:l?[l]:e.s_supportedImageType,Options:JSON.stringify(t.m_slideResourceOptions)})}}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return t.m_getItemsRequest.Items=t.m_itemsList,t.m_requestHeaders.set(u.CallerCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(u.XCorrelationId,r.CorrelationId||""),t.m_requestHeaders.set(u.IsBootRequest,r.IsBootRequest?r.IsBootRequest.toString():""),_define_property(_={},"action","getItemsResourceAsync"),_define_property(_,"correlationId",r.CorrelationId),_define_property(_,"server",(_define_property(p={},"start",e.performanceNowTrimmed()),_define_property(p,"end",e.performanceNowTrimmed()),p)),y=_,e.logPerf(y),[4,t.getItemsAsync("getItemsResourceAsync")];case 1:return h=I.sent(),y[u.server].end=e.performanceNowTrimmed(),h&&h.response&&h.response.headers&&(y[u.contentLength]=h.response.headers.get(u.ContentLength)),y[u.parser]=(_define_property(m={},"start",e.performanceNowTrimmed()),_define_property(m,"end",e.performanceNowTrimmed()),m),e.logPerf(y),v=t.setTimeoutForParsingResponse(y),[4,t.createSlideInfoResponse(t.parseMultipartResponseAsync(h,y),y)];case 2:return g=I.sent(),clearTimeout(v),y[u.parser].end=e.performanceNowTrimmed(),y[u.usedOutputCache]=!!g.usedOutputCache&&"true"===g.usedOutputCache.trim().toLowerCase(),y[u.itemUsedOutputCacheMap]=!!g.itemUsedOutputCacheMap&&Array.from(g.itemUsedOutputCacheMap.entries()),e.logPerf(y),g.metadata=t.generateReportPerfDictionary(y),[2,g]}}))}))()}},{key:"getItemsSlideOrderAndSlidesInfoIndexAsync",value:function(r,t,n){var o=this;return _async_to_generator((function(){var i,s,a,c,d,p,_,y;return _ts_generator(this,(function(h){switch(h.label){case 0:return o.m_getItemsRequest.Items.push({Id:l.PresinfoslimSlideOrder,AcceptTypes:[f.JsonType],Options:JSON.stringify(n)}),i=JSON.stringify(t),r&&r.forEach((function(e){o.m_getItemsRequest.Items.push({Id:"".concat(l.slideInfoIndex).concat(e),AcceptTypes:[f.ImagePng,f.ImageJpg],Options:i})})),_define_property(a={},"action","getItemsSlideOrderAndSlidesInfoIndexAsync"),_define_property(a,"server",(_define_property(s={},"start",e.performanceNowTrimmed()),_define_property(s,"end",e.performanceNowTrimmed()),s)),c=a,e.logPerf(c),[4,o.getItemsAsync("getItemsSlideOrderAndSlidesInfoIndexAsync")];case 1:return d=h.sent(),c[u.server].end=e.performanceNowTrimmed(),c[u.parser]=(_define_property(p={},"start",e.performanceNowTrimmed()),_define_property(p,"end",e.performanceNowTrimmed()),p),d&&d.response&&d.response.headers&&(c[u.contentLength]=d.response.headers.get(u.ContentLength)),e.logPerf(c),_=o.setTimeoutForParsingResponse(c),[4,o.createSlideOrderAndSlidesInfoIndexResponse(o.parseMultipartResponseAsync(d,c))];case 2:return y=h.sent(),clearTimeout(_),c[u.parser].end=e.performanceNowTrimmed(),c[u.usedOutputCache]=!!y.usedOutputCache&&"true"===y.usedOutputCache.trim().toLowerCase(),c[u.itemUsedOutputCacheMap]=!!y.itemUsedOutputCacheMap&&Array.from(y.itemUsedOutputCacheMap.entries()),e.logPerf(c),y.metadata=o.generateReportPerfDictionary(c),[2,y]}}))}))()}},{key:"getItemsPresInfoAndSlideInfoIndexAsync",value:function(r,t,n){var o=this;return _async_to_generator((function(){var i,s,a,c,d;return _ts_generator(this,(function(p){switch(p.label){case 0:return o.m_presInfoOptions.InputProperties.ClientHeight=n.ClientHeight?n.ClientHeight:o.m_presInfoInputProperties.ClientHeight,o.m_presInfoOptions.InputProperties.ClientWidth=n.ClientWidth?n.ClientWidth:o.m_presInfoInputProperties.ClientWidth,o.m_presInfoOptions.InputProperties.IsHighContrast=n.IsHighContrast?n.IsHighContrast:o.m_presInfoInputProperties.IsHighContrast,o.m_presInfoOptions.InputProperties.ClientColorSettings=n.ClientColorSettings?n.ClientColorSettings:o.m_presInfoInputProperties.ClientColorSettings,o.m_presInfoOptions.Filters.FilterHiddenSlideInfo=void 0!==n.FilterHiddenSlideInfo?n.FilterHiddenSlideInfo:o.m_presInfoFilters.FilterHiddenSlideInfo,o.m_presInfoOptions.Filters.IncludeSections=void 0!==n.IncludeSections?n.IncludeSections:o.m_presInfoFilters.IncludeSections,o.m_getItemsRequest.Items.push({Id:l.PresInfoMetaData,AcceptTypes:[f.JsonType],Options:JSON.stringify(o.m_presInfoOptions)}),i=JSON.stringify(t),r&&r.forEach((function(e){o.m_getItemsRequest.Items.push({Id:"".concat(l.slideInfoIndex).concat(e),AcceptTypes:[f.ImagePng,f.ImageJpg],Options:i})})),s={action:"getItemsPresInfoAndSlideInfoIndexAsync",server:{start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()}},[4,o.getItemsAsync("getItemsPresInfoAndSlideInfoIndexAsync")];case 1:return a=p.sent(),s[u.server].end=e.performanceNowTrimmed(),s[u.parser]={start:e.performanceNowTrimmed(),end:e.performanceNowTrimmed()},a&&a.response&&a.response.headers&&(s[u.contentLength]=a.response.headers.get(u.ContentLength)),c=o.setTimeoutForParsingResponse(s),[4,o.createPresInfoAndSlideInfoIndexResponse(o.parseMultipartResponseAsync(a,s))];case 2:return d=p.sent(),clearTimeout(c),s[u.parser].end=e.performanceNowTrimmed(),s[u.usedOutputCache]=!!d.usedOutputCache&&"true"===d.usedOutputCache.trim().toLowerCase(),s[u.itemUsedOutputCacheMap]=!!d.itemUsedOutputCacheMap&&Array.from(d.itemUsedOutputCacheMap.entries()),e.logPerf(s),d.metadata=o.generateReportPerfDictionary(s),[2,d]}}))}))()}},{key:"getPresInfoAsync",value:function(e){var r=this;return _async_to_generator((function(){var t,n,o;return _ts_generator(this,(function(i){switch(i.label){case 0:return v.sendTraceTag(508420483,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::getPresInfoAsync - Function:".concat(e,", requestCorrelation:").concat(r.m_requestHeaders.get(u.CallerCorrelationId))),t=new AbortController,n=setTimeout((function(){return t.abort()}),3e4),[4,fetch("".concat(r.m_podsUrl,"/presinfo.ashx"),{headers:r.m_requestHeaders,method:"POST",body:JSON.stringify(r.m_getPresInfoRequest),signal:t.signal}).catch(function(){var r=_async_to_generator((function(r){return _ts_generator(this,(function(t){throw v.sendTraceTag(508420482,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getPresInfo - Function: ".concat(e,", Error: ").concat(r)),r}))}));return function(e){return r.apply(this,arguments)}}())];case 1:return o=i.sent(),clearTimeout(n),v.sendTraceTag(508420481,p.msoulscat_Wac_PptSession,o.ok?_.Info:_.Error,"PodsProxy::getPresInfo - Function: ".concat(e,", Status:").concat(o.status,", StatusText: ").concat(o.statusText,", CorrelationId: ").concat(o.headers.get(u.XCorrelationId))),[2,o]}}))}))()}},{key:"logGetItemFailureServerHeaders",value:function(e,r,t,n){return _async_to_generator((function(){var o;return _ts_generator(this,(function(i){return(o={functionName:e,requestCorrelation:r,usePresentFrontDoor:t}).headerCorrelationId=n&&n.headers?n.headers.get(u.XCorrelationId):u.unknown,o.headerErrorCode=n&&n.headers?n.headers.get(u.ErrorCode):u.unknown,o.xHeaderErrorCode=n&&n.headers?n.headers.get(u.XErrorCode):u.unknown,o.headerErrorCategory=n&&n.headers?n.headers.get(u.ErrorCategory):u.unknown,o.headerErrorIntentional=!(!n||!n.headers)&&n.headers.get(u.IsIntentional),o.status=n&&n.status?n.status:u.unknown,v.sendTraceTag(506852878,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:logGetItemFailureServerHeaders - ".concat(JSON.stringify(o))),[2]}))}))()}},{key:"getItemsAsync",value:function(r,t){var n=this;return _async_to_generator((function(){var o,i,s,a,l,f,y,h,m,g,I,b;return _ts_generator(this,(function(w){switch(w.label){case 0:return o=n.m_requestHeaders.get(u.CallerCorrelationId),v.sendTraceTag(508420480,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::getItemsAsync - Function:".concat(r,", requestCorrelation:").concat(o)),i=_define_property({},"errorCode",c.ErrorRESERVEDSuccess),s=i,a="getItemsPresInfoAndSlideInfoAsync"===r&&n.m_settings.shouldUseBootRequestTimeout&&n.m_settings.bootRequestTimeout?n.m_settings.bootRequestTimeout:n.m_settings.timeout,t&&t.overrideGetItemsTimeoutMs&&(a=t.overrideGetItemsTimeoutMs),n.m_requestHeaders.set(u.dateHeader,(new Date).toISOString()),n.m_requestHeaders.set(u.clientTimeoutHeader,a.toString()),n.m_requestHeaders.set(u.callId,n.m_settings.callId||"empty"),l=!1,f="".concat(n.m_podsUrl,"/getitems.ashx"),y=t&&t.isGetSlideCommentsRequest,n.m_settings.shouldFixSlideDataOrder&&(y&&n.m_wacFallbackDownloadUrl?n.m_getItemsRequest.Source.DownloadUrl=n.m_wacFallbackDownloadUrl:n.m_getItemsRequest.Source.DownloadUrl=n.m_downloadUrl),y||!n.m_settings.pptoPresentFrontDoorEnabled&&!S.readBooleanOrDefault("enableUsePresentFrontdoor",!1)||(n.m_presentUrl?(f="".concat(n.m_presentUrl,"/items"),l=!0):v.sendTraceTag(508420451,p.msoulscat_Wac_PptSession,_.Warning,"PodsProxy::getItemsAsync enableUsePresentFrontdoor is true but presentUrl is null. Using podsUrl. }")),h=n.m_getItemsRequest.Items.map((function(e){return e.Id})),e.s_events.emit("networkCall",{url:f,itemIds:h}),m=new AbortController,g=setTimeout((function(){return m.abort()}),a),[4,fetch(f,{headers:n.m_requestHeaders,method:"POST",body:JSON.stringify(n.m_getItemsRequest),signal:m.signal}).catch(function(){var t=_async_to_generator((function(t){var s,a,f,y,h,m,g,I;return _ts_generator(this,(function(S){return s=t.response&&t.response.headers?t.response.headers.get(u.XCorrelationId):u.unknown,a=t.response&&t.response.headers?t.response.headers.get(u.ErrorCode):u.unknown,f=t.response&&t.response.headers?t.response.headers.get(u.XErrorCode):u.unknown,y=t.response&&t.response.headers?t.response.headers.get(u.ErrorCategory):u.unknown,h=!(!t.response||!t.response.headers)&&t.response.headers.get(u.IsIntentional),m=t.response&&t.response.status?t.response.status:u.unknown,(g=t.toString()).length>0&&("."===g.slice(-1)||""===g.slice(-1))&&(g=g.slice(0,-1)),(I=n.getMappedError(g))?i.errorCode=I:"HTTPError"===t.name&&m!==u.unknown&&500!==m&&n.m_errorMap.has(m)?i.errorCode=n.m_errorMap.get(m):"TimeoutError"===t.name?i.errorCode=c.ErrorRequestTimeout:i.errorCode=e.convertServerError(a,n.m_settings.enableServerSpecificErrorCode),n.m_settings.shouldUpdateNewFileUrlFromSnap&&i.errorCode===c.ServerErrorFileDownloadResourceInconsistent&&(i.newSnapUrl=e.getFieldFromReponseHeader(t.response,u.newSnapUrlHeader)),i.errorCategory=y&&""!==y.trim()&&y!==u.unknown?y:d.Transient,i.isIntentional=h!==u.unknown&&h,v.sendTraceTag(595687001,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getItems - Function:".concat(r,", Error:").concat(t,", ErrorName:").concat(t.name,", Status:").concat(t.status,", HeaderCorrelationId:").concat(s,", HeaderErrorCode:").concat(a,", HeaderErrorCategory:").concat(y,", result.isIntentional:").concat(i.isIntentional,", result.errorCode:").concat(i.errorCode,", requestCorrelation:").concat(o,", status:").concat(m,", xErrorCode:").concat(f,", usePresentFrontDoor:").concat(l)),[2,i]}))}));return function(e){return t.apply(this,arguments)}}())];case 1:return s=w.sent(),v.sendTraceTag(506852877,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy:getItemsAsync - fixErrorLoggingGetItemsPodsProxy: ".concat(S.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1))),S.readBooleanOrDefault("fixErrorLoggingGetItemsPodsProxy",!1)&&s&&!1===s.ok?[4,n.logGetItemFailureServerHeaders(r,o,l,s)]:[3,3];case 2:w.sent(),w.label=3;case 3:clearTimeout(g),i.response=s;try{if(n.m_settings.shouldUpdateNewFileUrlFromSnap&&(i.errorCode===c.ServerErrorFileDownloadResourceInconsistent||i.newSnapUrl)){if(v.sendTraceTag(508420449,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy:getItems trigger shouldUpdateNewFileUrlFromSnap flow"),i.newSnapUrl)return i.errorCode===c.ErrorRESERVEDSuccess&&v.sendTraceTag(508420448,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:got new snap url without errorcode"),v.sendTraceTag(508420447,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy:getItems get valid new file url"),n.events.emit("downloadUrlChanged",i.newSnapUrl),[2,i];v.sendTraceTag(508420446,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){v.sendTraceTag(508420445,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return 200!==s.status&&i.errorCode===c.ErrorRESERVEDSuccess&&(s.headers&&s.headers.get(u.ErrorCode)?(i[u.errorCode]=e.convertServerError(s.headers.get(u.ErrorCode),n.m_settings.enableServerSpecificErrorCode),i[u.errorCategory]=s.headers.get(u.ErrorCategory)?s.headers.get(u.ErrorCategory):d.BadRequest,i[u.IsIntentional]=!!s.headers.get(u.IsIntentional)&&s.headers.get(u.IsIntentional)):(s.status!==u.unknown&&n.m_errorMap.has(s.status)?i[u.errorCode]=n.m_errorMap.get(s.status):i[u.errorCode]=c.ErrorRequestFailed,i[u.errorCategory]=d.Transient,i[u.IsIntentional]=!1)),_define_property(I={},"functionName",r),_define_property(I,"status",s.status),_define_property(I,"statusText",s.statusText),_define_property(I,"headerCorrelation",s.headers?s.headers.get(u.XCorrelationId):""),_define_property(I,"headerErrorCode",s.headers?s.headers.get(u.ErrorCode):""),_define_property(I,"headerErrorCategory",s.headers?s.headers.get(u.ErrorCategory):""),_define_property(I,"headerErrorIntentional",!!s.headers&&s.headers.get(u.IsIntentional)),_define_property(I,"requestCorrelation",o),_define_property(I,"resultErrorCode",i.errorCode),_define_property(I,"resultErrorCategory",i.errorCategory),_define_property(I,"resultIsIntentional",i.IsIntentional),b=I,v.sendTraceTag(595687002,p.msoulscat_Wac_PptSession,s.ok?_.Info:_.Error,JSON.stringify(b)),[2,i]}}))}))()}},{key:"getSessionUtcAsync",value:function(){var e=this;return _async_to_generator((function(){var r,t,n,o,i;return _ts_generator(this,(function(s){switch(s.label){case 0:return r=-1,t=new AbortController,n=setTimeout((function(){return t.abort()}),2500),[4,fetch("".concat(e.m_podsUrl,"/podhandler.ashx?action=GetSessionUTC&format=jsms"),{headers:new Headers,method:"GET",signal:t.signal}).catch(function(){var e=_async_to_generator((function(e){return _ts_generator(this,(function(r){return v.sendTraceTag(508420444,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getSessionUtcAsync - Error: ".concat(e)),[2]}))}));return function(r){return e.apply(this,arguments)}}())];case 1:o=s.sent(),clearTimeout(n),s.label=2;case 2:return s.trys.push([2,6,,7]),o?[4,o.text()]:[3,4];case 3:return r=parseInt.apply(void 0,[s.sent(),10]),v.sendTraceTag(508420443,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::getSessionUtcAsync: ".concat(r)),[3,5];case 4:v.sendTraceTag(508420442,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getSessionUtcAsync - Null response."),s.label=5;case 5:return[3,7];case 6:return i=s.sent(),v.sendTraceTag(508420441,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::getSessionUtcAsync - error parsing response. ".concat(i)),[3,7];case 7:return[2,r]}}))}))()}},{key:"updateDocSource",value:function(e){v.sendTraceTag(508420440,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy - call updateDocSource."),this.m_getPresInfoRequest?this.m_getPresInfoRequest.Source=e:v.sendTraceTag(508420439,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::updateDocSource - no valid m_getPresInfoRequest to update."),this.m_getItemsRequest?this.m_getItemsRequest.Source=e:v.sendTraceTag(508420438,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::updateDocSource - no valid m_getItemsRequest to update.")}},{key:"generateSnapDownloadUrlAsync",value:function(e,r){var t=this;return _async_to_generator((function(){var n,o,i,s,a,c,d,l;return _ts_generator(this,(function(f){switch(f.label){case 0:return f.trys.push([0,4,,5]),v.sendTraceTag(508420437,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::generateSnapDownloadUrlAsync - snapDownloadUrlRequest.ID: ".concat(e.ID,".")),(n=new Headers).append(u.ContentType,"application/json; charset=utf-8"),n.append(u.CallerCorrelationId,e.ID),r&&r.forEach((function(e,r){n.append(r,e)})),o="".concat(t.m_podsUrl,"/SnapUrlHandler.ashx"),i=new AbortController,s=setTimeout((function(){return i.abort()}),t.m_settings.timeout),[4,fetch(o,{headers:n,method:"POST",body:JSON.stringify(e),signal:i.signal}).catch(function(){var e=_async_to_generator((function(e){return _ts_generator(this,(function(r){return v.sendTraceTag(508420436,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:generateSnapDownloadUrlAsync - error when calling SnapUrlHandler : ".concat(e)),[2]}))}));return function(r){return e.apply(this,arguments)}}())];case 1:return a=f.sent(),clearTimeout(s),c="",a?[4,a.json()]:[3,3];case 2:d=f.sent(),v.sendTraceTag(508420435,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy:generateSnapDownloadUrlAsync - snapUrlResponse, FSuccess:".concat(d.FSuccess,", ErrorCode:").concat(d.ErrorCode)),d.FSuccess?c=d.SnapUrl:v.sendTraceTag(508420434,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:generateSnapDownloadUrlAsync - snap url failed with errorCode : ".concat(d.ErrorCode)),f.label=3;case 3:return[2,c];case 4:return l=f.sent(),v.sendTraceTag(508420433,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:generateSnapDownloadUrlAsync - exception: ".concat(l)),[2,""];case 5:return[2]}}))}))()}},{key:"setErrorMap",value:function(){for(var e=["cancelled","cancelado","","Abgebrochen","","","annul","","avbruten","","annullato","zrueno","poniteno","geannuleerd","","avbrutt","annulleret","",""," hu","Kumottu","dibatalkan","vazgeildi","anulat","anulowane","","visszavonva"],r=0;r<e.length;r+=1)this.m_errorMap.set(e[r],c.ErrorRequestCanceled);for(var t=["The network connection was lost","Could not connect to the server","connection was lost","The internet connection appears to be offline","La conexin de red se perdi","","La connexion rseau a t perdue","  ","","","   ","","Ntverksanslutningen frlorades","A conexo de rede foi perdida","A balants kesildi","Die Netzwerkverbindung wurde unterbrochen","La connessione  stata persa","A ligao  rede foi interrompida","Mistet nettverksforbindelsen","La conexin de red se ha perdido",""," mt kt ni mng","Kehilangan jaringan koneksi","   ","","  ","Verkkoyhteys katkesi","Netvrksforbindelsen gik tabt","Bylo ztraceno pipojen k sti","Poczenie sieciowe zostao utracone","A conexo  internet parece estar desativada","The Internet connection appears to be offline","La conexin a Internet parece estar desactivada","Could not connect to the server","De netwerkverbinding is verbroken","Conexiunea de reea a fost pierdut","","  ","NetworkError when attempting to fetch resource","","No se ha podido establecer conexin con el servidor","Tidak dapat terhubung ke server","","No se pudo establecer conexin con el servidor","A hlzati kapcsolat megszakadt"],n=0;n<t.length;n+=1)this.m_errorMap.set(t[n],c.ErrorConnectionLost);for(var o=["Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","No se pudo completar la operacin. El software caus la anulacin de la conexin","Khng th hon tt tc v. Phn mm  khin kt ni b hy b","  .       ","   .    ","The operation couldnt be completed. Software caused connection abort","Toimintoa ei voitu suorittaa. Ohjelmistosta johtuva yhteyden keskeytys","Lopration na pas pu sachever. Interruption de la connexion due au logiciel","Operasi tidak dapat diselesaikan. Perangkat lunak menyebabkan pemutusan koneksi","No se pudo completar la operacin. El software caus la anulacin de la conexin","A operao no pde ser concluda. O software provocou o cancelamento da conexo","No se ha podido completar la operacin. El software ha causado la anulacin de la conexin","Impossibile completare l'operazione. Il software ha provocato l'interruzione della connessione","Der Vorgang konnte nicht abgeschlossen werden. Die Software hat einen Verbindungsabbruch verursacht","","",""," ","","Postupak se nije mogao dovriti. Softver je uzrokovao prekid veze","tgrden kunde inte slutfras. Program orsakade avbrott i anslutningen","lem tamamlanamad. Yazlm balantnn kesilmesine neden oldu","   .   "],i=0;i<o.length;i+=1)this.m_errorMap.set(o[i],c.ErrorSoftwareConnectionAbort);for(var s=["The request timed out","","La requte a expir","","Se agot el tiempo de espera","Esgotou-se o tempo limite da solicitao",""],a=0;a<s.length;a+=1)this.m_errorMap.set(s[a],c.ErrorRequestTimeout);for(var u=["cannot parse response","impossible danalyser la rponse",""],d=0;d<u.length;d+=1)this.m_errorMap.set(u[d],c.ErrorCannotParseResponse);this.m_errorMap.set("The operation was aborted",c.ErrorRequestAbort),this.m_errorMap.set("Failed to fetch",c.ErrorFailedToFetch),this.m_errorMap.set(404,c.ErrorRequestFailedServerNotFound),this.m_errorMap.set(502,c.ErrorRequestFailedBadGateway),this.m_errorMap.set(503,c.ErrorRequestFailedServiceUnavailable),this.m_errorMap.set(504,c.ErrorRequestFailedGatewayTimeout)}},{key:"getMappedError",value:function(r){var t=r;return(t=e.trimErrorName(t,["TypeError:","Loading failed:"])).indexOf("Bylo ztraceno")>=0?c.ErrorConnectionLost:t.indexOf("AbortError:")>=0?c.ErrorRequestAbort:this.m_errorMap.get(t)}},{key:"parseMultipartResponseAsync",value:function(r,t,i){var s=this;return _async_to_generator((function(){var a,l,f,y,h,m,g,b,w,C,P,E,x,O,A,M,T,k,R,j,N,W,U,D,F,H,L,J,q,B,G,z,V,K,X,$,Y,Q,Z,ee,re,te,ne;return _ts_generator(this,(function(oe){switch(oe.label){case 0:if(a={},l={itemErrorCodeMap:new Map,itemErrorCategoryMap:new Map,itemUsedOutputCacheMap:new Map,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:d.ErrorRESERVEDSuccess,responseIsIntentional:!1,data:void 0},f={slideOrder:[],slideAllInfo:[]},t[u.firstResponseCheck]=(_define_property(y={},"start",e.performanceNowTrimmed()),_define_property(y,"end",e.performanceNowTrimmed()),y),!(r.response&&r.response.body&&r.response.headers&&r.response.headers.get(u.ContentType)))return[3,12];h=r.response,m="";try{t[u.fetchBoundary]=(_define_property(g={},"start",e.performanceNowTrimmed()),_define_property(g,"end",e.performanceNowTrimmed()),g),m=s.m_multipartParser.fetchBoundary(h.headers.get(u.ContentType)),t[u.fetchBoundary].end=e.performanceNowTrimmed()}catch(e){return b=h.headers.get(u.ErrorCode),w=h.headers.get(u.ErrorCategory),C=!!r[u.IsIntentional]&&r[u.IsIntentional],P=h.headers.get(u.XCorrelationId),v.sendTraceTag(508420432,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::parseMultipartResponse - fetchBoundary Content-Type header: ".concat(h.headers.get(u.ContentType),", ErrorCode:").concat(b,", ErrorCategory:").concat(w,", IsIntentional:").concat(C," , Correlation:").concat(P,", Exception:").concat(e)),l.responseErrorCode=b||c.ErrorRequestFailed,l.responseErrorCategory=w||d.BadRequest,[2,l]}return E=e.performanceNowTrimmed(),t[u.downloadResponse]=(_define_property(x={},"start",E),_define_property(x,"end",E),x),v.sendTraceTag(508420431,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::parseMultipartResponse - download response stream start: ".concat(E)),i&&i.requestType===n.getItemsPresInfoAndSlideInfoAsync&&s.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:o.DownloadResponseStream}),O=!1,A=void 0,M=null,k=h.headers?h.headers.get(u.ContentLength):-1,R=-1,v.sendTraceTag(508420430,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy:shouldUseResponseStreamWhenReceivedTotalLength: ".concat(s.m_settings.shouldUseResponseStreamWhenReceivedTotalLength)),s.m_settings.parsingWhileDownloadingEnabled?(j=!1,N=!1,W=function(r){var a;j=!0,N=r;var c=(_define_property(a={},"receivedDataLength",R),_define_property(a,"responseContentLength",k),_define_property(a,"duration",e.performanceNowTrimmed()-E),_define_property(a,"downloadFailed",N),a);v.sendTraceTag(508420429,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy - return from response stream reading. ".concat(JSON.stringify(c)));var d=e.performanceNowTrimmed();v.sendTraceTag(508420428,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::parseMultipartResponse - download response stream end: ".concat(d,", duration: ").concat(d-E)),t[u.downloadResponse].end=d,t[u.downloadResponse].length=R,!O&&i&&i.requestType===n.getItemsPresInfoAndSlideInfoAsync&&s.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:o.ParseMultipartResponse})},R=0,U=h.body,D=_sliced_to_array(U.tee(),2),F=D[0],H=D[1],L=new Promise(function(){var e=_async_to_generator((function(e){var r,t,n,o,i,s;return _ts_generator(this,(function(a){switch(a.label){case 0:a.trys.push([0,4,,5]),r=S.readNumberOrDefault("hackMaxBytes",-1),t=F.getReader(),a.label=1;case 1:return[4,t.read()];case 2:if(n=a.sent(),o=n.done,i=n.value,o)return W(!1),e(),[3,3];if(i&&(R+=i.length,r>0&&R>r))throw"hackMaxBytes hit";return[3,1];case 3:return[3,5];case 4:return s=a.sent(),v.sendTraceTag(508420427,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::measuringDownloadPromise - exception ".concat(s,".")),W(!0),e(),[3,5];case 5:return[2]}}))}));return function(r){return e.apply(this,arguments)}}()),i&&i.shouldTimeoutResponseStreamDownload&&(q=i&&i.overrideDownloadTimeoutMs?i.overrideDownloadTimeoutMs:s.m_settings.responseStreamDownloadTimeout?s.m_settings.responseStreamDownloadTimeout:3e4,J=window.setTimeout((function(){j||(O=!0,v.sendTraceTag(508420426,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),v.sendTraceTag(508420425,p.msoulscat_Wac_PptSession,_.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),F.cancel(),H.cancel())}),q)),B=new I(s.m_settings,a,t,l),G=s.m_multipartParser.processMultipartBinaryResponse(H.getReader(),m,(function(e){B.parsePart(e)})),[4,Promise.all([L,G])]):[3,2];case 1:if(oe.sent(),N)return l.responseErrorCode=c.ErrorRequestFailed,l.responseErrorCategory=d.Transient,l.data=void 0,[2,l];if(i&&i.shouldTimeoutResponseStreamDownload&&(clearTimeout(J),v.sendTraceTag(508420424,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy - response download check. ".concat(JSON.stringify({hasTimeout:O,shouldUseResponseStreamWhenReceivedTotalLength:s.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:R,responseContentLength:k})))),O){if(!(s.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&k>0&&R>0&&k===R))return l.responseErrorCode=c.ErrorDownloadResponseStreamTimeout,[2,l];v.sendTraceTag(508420423,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens")}return f=B.parsedResponse,[3,11];case 2:return i&&i.shouldTimeoutResponseStreamDownload?(z=i&&i.overrideDownloadTimeoutMs?i.overrideDownloadTimeoutMs:s.m_settings.responseStreamDownloadTimeout?s.m_settings.responseStreamDownloadTimeout:3e4,V="downloadResponseStreamTimeout",X=new Promise((function(e){A=setTimeout((function(){v.sendTraceTag(508420422,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::parseMultipartResponse - download response stream timeout."),K&&(v.sendTraceTag(508420421,p.msoulscat_Wac_PptSession,_.Warning,"PodsProxy::parseMultipartResponse - cancel reading current response stream due to timeout"),K.cancel()),e(V)}),z)})),K=h.body.getReader(),(M=s.readResponseStream(K,k)).then((function(r){var t={receivedDataLength:R=r&&r.length||-1,responseContentLength:k,duration:e.performanceNowTrimmed()-E};v.sendTraceTag(508420420,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy - return from response stream reading. ".concat(JSON.stringify(t)))})),[4,Promise.race([M,X])]):[3,4];case 3:return(T=oe.sent())===V?O=!0:void 0!==A&&clearTimeout(A),[3,6];case 4:return $=Uint8Array.bind,[4,h.arrayBuffer()];case 5:T=new($.apply(Uint8Array,[void 0,oe.sent()])),(Y=S.readNumberOrDefault("hackMaxBytes",-1))>0&&T.length>Y&&(T=T.slice(0,Y)),oe.label=6;case 6:return i&&i.shouldTimeoutResponseStreamDownload&&v.sendTraceTag(508420419,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy - response download check. ".concat(JSON.stringify({hasTimeout:O,shouldUseResponseStreamWhenReceivedTotalLength:s.m_settings.shouldUseResponseStreamWhenReceivedTotalLength,receivedDataLength:R,responseContentLength:k}))),O?s.m_settings.shouldUseResponseStreamWhenReceivedTotalLength&&M&&k>0&&R>0&&k===R?(v.sendTraceTag(508420418,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy:parseMultipartResponse - try to use already returned response stream when timeout happens"),[4,M]):[3,8]:[3,9];case 7:return T=oe.sent(),[3,9];case 8:return l.responseErrorCode=c.ErrorDownloadResponseStreamTimeout,[2,l];case 9:return Q=e.performanceNowTrimmed(),v.sendTraceTag(508420417,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::parseMultipartResponse - download response stream end: ".concat(Q,", duration: ").concat(Q-E)),Z=T,t[u.downloadResponse].end=Q,Z&&Z.length&&(t[u.downloadResponse].length=Z.length),i&&i.requestType===n.getItemsPresInfoAndSlideInfoAsync&&s.events.emit("requestStageChanged",{requestType:i.requestType,stageInfo:o.ParseMultipartResponse}),ee=new I(s.m_settings,a,t,l),[4,s.m_multipartParser.processMultipartBinaryResponse(Z,m,(function(e){ee.parsePart(e)}))];case 10:oe.sent(),f=ee.parsedResponse,oe.label=11;case 11:return[3,13];case 12:re=r.hasOwnProperty(u.errorCode)&&r[u.errorCode]!==c.ErrorRESERVEDSuccess?r[u.errorCode]:c.ErrorRequestFailed,te=r[u.errorCategory]?r[u.errorCategory]:d.BadRequest,ne=!!r[u.IsIntentional]&&r[u.IsIntentional],l.responseErrorCode=re,l.responseErrorCategory=te,v.sendTraceTag(508420416,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::parseMultipartResponse - responseErrorCode:".concat(re,", responseErrorCategory:").concat(te,", IsIntentional:").concat(ne)),oe.label=13;case 13:for(var ie in t[u.firstResponseCheck].end=e.performanceNowTrimmed(),l.responseErrorCode!==c.ErrorRESERVEDSuccess&&l.responseErrorCategory===d.ErrorRESERVEDSuccess&&(l.responseErrorCategory=d.BadRequest,v.sendTraceTag(508420387,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::parseMultipartResponse - parsedResponse contains errorCode but no errorCategory. responseErrorCode:".concat(l.responseErrorCode))),a)f.slideAllInfo.push({ID:a[ie].ID,SlideImageData:a[ie].SlideImageData,SlideShowInfo:a[ie].SlideShowInfo,Title:a[ie].Title,NoteHtml:a[ie].NoteHtml,Comments:a[ie].Comments,HasAnimation:a[ie].HasAnimation,Hidden:a[ie].Hidden,HasTransition:a[ie].HasTransition,ResourceData:a[ie].ResourceData,AccessibilityModel:a[ie].AccessibilityModel,MediaUrls:a[ie].MediaUrls});try{if(S.readBooleanOrDefault("shouldUpdateNewFileUrlFromSnapTrailerItem",!1)&&(l.itemErrorCodeMap&&Object.values(l.itemErrorCodeMap).includes(c.ServerErrorFileDownloadResourceInconsistent)||l.newSnapUrl)){if(l.newSnapUrl)return 0===l.itemErrorCodeMap.size&&v.sendTraceTag(508420386,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:got new snap url without errorcode"),v.sendTraceTag(508420385,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy:getItems get valid new file url"),s.events.emit("downloadUrlChanged",l.newSnapUrl),[2,l];v.sendTraceTag(508420384,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getItems no valid new file url in ServerErrorFileDownloadResourceInconsistent response")}}catch(e){v.sendTraceTag(508420383,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy:getItems exception trying to check ServerErrorFileDownloadResourceInconsistent")}return l.data=f,[2,l]}}))}))()}},{key:"readResponseStream",value:function(e,r){var t=this;return _async_to_generator((function(){var n,o,i,s;return _ts_generator(this,(function(a){switch(a.label){case 0:n=new Uint8Array(0),a.label=1;case 1:return a.trys.push([1,6,,7]),[4,e.read()];case 2:o=a.sent(),a.label=3;case 3:if(o.done)return[3,5];if(n=new Uint8Array(_to_consumable_array(n).concat(_to_consumable_array(o.value))),(i=S.readNumberOrDefault("hackMaxBytes",-1))>0&&n.length>i)throw n=n.slice(0,i),"hackMaxBytes hit";return r>0&&n.length===r&&(v.sendTraceTag(508420382,p.msoulscat_Wac_PptSession,_.Info,"PodsProxy::readResponseStream - received length reached content length: ".concat(r)),t.m_settings.shouldUseResponseStreamWhenReceivedTotalLength)?[3,5]:[4,e.read()];case 4:return o=a.sent(),[3,3];case 5:return[3,7];case 6:return s=a.sent(),v.sendTraceTag(508420381,p.msoulscat_Wac_PptSession,_.Error,"PodsProxy::readResponseStream - exception ".concat(s,".")),[2,new Uint8Array(0)];case 7:return[2,n]}}))}))()}},{key:"generateReportPerfDictionary",value:function(e){var r={};return e[u.action]&&(r[u.action]=e[u.action]),e[u.correlationId]&&(r[u.correlationId]=e[u.correlationId]),e[u.server]&&(r[u.server]=e[u.server]),e[u.parser]&&(r[u.parser]=e[u.parser]),e[u.downloadResponse]&&(r[u.downloadResponse]=e[u.downloadResponse]),e[u.usedOutputCache]&&(r[u.usedOutputCache]=e[u.usedOutputCache]),e[u.contentLength]&&(r[u.contentLength]=e[u.contentLength]),r}},{key:"createPresInfoAndSlideInfoResponse",value:function(r,t){var n,o=(c.ErrorRESERVEDSuccess,d.ErrorRESERVEDSuccess);return t[u.createResponse]=(_define_property(n={},"start",e.performanceNowTrimmed()),_define_property(n,"end",e.performanceNowTrimmed()),n),o={itemErrorCodeMap:r.itemErrorCodeMap,itemErrorCategoryMap:r.itemErrorCategoryMap,responseErrorCode:r.responseErrorCode,responseErrorCategory:r.responseErrorCategory,responseIsIntentional:!1,presInfo:r.data&&r.data.slideAllInfo&&r.data.slideAllInfo.length>0?r.data.slideAllInfo[0]:void 0,slideInfo:r.data&&r.data.slideAllInfo?r.data.slideAllInfo.slice(1):[],usedOutputCache:r.usedOutputCache,itemUsedOutputCacheMap:r.itemUsedOutputCacheMap},t[u.createResponse].end=e.performanceNowTrimmed(),o}},{key:"createSlideInfoResponse",value:function(r,t){var n=this;return _async_to_generator((function(){var o,i;return _ts_generator(this,(function(s){switch(s.label){case 0:return o={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:d.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[]},t[u.createResponse]=(_define_property(i={},"start",e.performanceNowTrimmed()),_define_property(i,"end",e.performanceNowTrimmed()),i),[4,r.then((function(e){n.m_settings.shouldFixSlideDataOrder&&n.fixSlideImageDataOrder(e),o={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return s.sent(),t[u.createResponse].end=e.performanceNowTrimmed(),[2,o]}}))}))()}},{key:"fixSlideImageDataOrder",value:function(e){e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.forEach((function(e){if(e&&e.ResourceData&&e.SlideShowInfo&&e.SlideShowInfo.sld){var r=new Map(e.ResourceData.map((function(e){return[e.Id,e.Base64]})));e.SlideShowInfo.sld.forEach((function(e){e.resCat.forEach((function(e){r.has(e.id)&&""===e.base64&&(e.base64=r.get(e.id))}))}))}}))}},{key:"createSlideIdResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:d.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"createPresInfoResponse",value:function(e){var r=this;return _async_to_generator((function(){var t;return _ts_generator(this,(function(n){switch(n.label){case 0:return t={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCode:c.ErrorRESERVEDSuccess,responseErrorCategory:d.ErrorRESERVEDSuccess,responseIsIntentional:!1,presInfo:void 0},[4,e.then((function(e){r.m_settings.shouldFixSlideDataOrder&&r.fixHiddenSlideOrder(e),t={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,presInfo:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0]:void 0,usedOutputCache:e.usedOutputCache,itemUsedOutputCacheMap:e.itemUsedOutputCacheMap}}))];case 1:return n.sent(),[2,t]}}))}))()}},{key:"fixHiddenSlideOrder",value:function(e){e.data.slideAllInfo[0].HiddenSlideOrder=e.data.slideAllInfo[0].HiddenSlideOrder?e.data.slideAllInfo[0].HiddenSlideOrder:[]}},{key:"createSlideOrderAndSlidesInfoIndexResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:d.ErrorRESERVEDSuccess,responseErrorCode:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideOrder?e.data.slideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo:[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"createPresInfoAndSlideInfoIndexResponse",value:function(e){return _async_to_generator((function(){var r;return _ts_generator(this,(function(t){switch(t.label){case 0:return r={itemErrorCodeMap:void 0,itemErrorCategoryMap:void 0,itemUsedOutputCacheMap:void 0,responseErrorCategory:d.ErrorRESERVEDSuccess,responseErrorCode:c.ErrorRESERVEDSuccess,responseIsIntentional:!1,slideInfo:[],slideId:[]},[4,e.then((function(e){r={itemErrorCodeMap:e.itemErrorCodeMap,itemErrorCategoryMap:e.itemErrorCategoryMap,responseErrorCode:e.responseErrorCode,responseErrorCategory:e.responseErrorCategory,responseIsIntentional:!1,slideId:e.data&&e.data.slideAllInfo&&e.data.slideAllInfo.length>0?e.data.slideAllInfo[0].SlideOrder:[],slideInfo:e.data&&e.data.slideAllInfo?e.data.slideAllInfo.slice(1):[],itemUsedOutputCacheMap:e.itemUsedOutputCacheMap,metadata:e.metadata,usedOutputCache:e.usedOutputCache}}))];case 1:return t.sent(),[2,r]}}))}))()}},{key:"setTimeoutForParsingResponse",value:function(e){return window.setTimeout((function(){v.sendTraceTag(508420380,p.msoulscat_Wac_PptSession,_.Warning,"Parsing didn't finish in the time. ".concat(JSON.stringify(e)))}),this.m_settings&&this.m_settings.parseResponseTimeout?this.m_settings.parseResponseTimeout:25e3)}},{key:"objectDictionaryToRequestIdString",value:function(e){var r="";for(var t in e)e[t]&&(r="".concat(r).concat(t,"=").concat(e[t],";"));return r}}],[{key:"getFieldFromReponseHeader",value:function(e,r){return e.headers?e.headers.get(r):u.unknown}},{key:"trimErrorName",value:function(e,r){for(var t=e,n=0;n<r.length;n+=1)t.lastIndexOf(r[n])>=0&&(t=t.substring(t.lastIndexOf(r[n])+r[n].length));return t?t.trim():""}},{key:"convertServerError",value:function(e,r){return r&&e&&""!==e.trim()&&e!==u.unknown?"Server".concat(e):c.ErrorRequestFailed}},{key:"logPerf",value:function(e){}},{key:"ensureISlideInfoFilters",value:function(e){return e&&void 0!==e.EnableClustering?e:{EnableClustering:!1,ExportAsImages:!1}}},{key:"performanceNowTrimmed",value:function(){return Math.round(performance.now())}},{key:"logPerformanceEntries",value:function(e,r){var t=e.getEntriesByType("resource"),n={},o=!0,i=!1,s=void 0;try{for(var a,u=t[Symbol.iterator]();!(o=(a=u.next()).done);o=!0){var c=a.value;if("fetch"===c.initiatorType){var d=!1,l=!0,f=!1,y=void 0;try{for(var m,g=r[Symbol.iterator]();!(l=(m=g.next()).done);l=!0){var I=m.value;if(c.name.indexOf(I)>0||c.name.startsWith(I)){d=!0;break}}}catch(e){f=!0,y=e}finally{try{l||null==g.return||g.return()}finally{if(f)throw y}}if(d){if(n.name=c.name,n.dateTime=performance.now(),h.ChangeGate.isChangeGateEnabled("PodsProxy.recordPerfTimingUrlParts")){var S=new URL(c.name);n.hostname=S.hostname,n.pathname=S.pathname}n.start=c.startTime,n.redirectStart=c.redirectStart,n.redirectEnd=c.redirectEnd,n.domainLookupStart=c.domainLookupStart,n.domainLookupEnd=c.domainLookupEnd,n.tcpHandshakeStart=c.connectStart,n.tcpHandshakeEnd=c.connectEnd,n.secureConnectionStart=c.secureConnectionStart,n.responseStart=c.responseStart,n.responseEnd=c.responseEnd,n.fetchStart=c.fetchStart,n.requestStart=c.requestStart,"decodedBodySize"in c&&(n.decodedBodySize=c.decodedBodySize),"encodedBodySize"in c&&(n.encodedBodySize=c.encodedBodySize),"transferSize"in c&&(n.transferSize=c.transferSize),Object.keys(n).length>0&&v.sendTraceTag(572379986,p.msoulscat_Wac_PptSession,_.Info,"".concat(JSON.stringify(n)))}}}}catch(e){i=!0,s=e}finally{try{o||null==u.return||u.return()}finally{if(i)throw s}}}}]),e}();return C.s_events=new g.EventEmitter,C.s_supportedImageType=[f.ImagePng,f.ImageJpg],i}()}));
//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/PodsProxy.js.map/a7293f1e490d26df66337dbcd3debe09/PodsProxy.js.map